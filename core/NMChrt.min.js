/**
 * Plugin Name: Nomanic Objects
 * Plugin URI: http://www.nomanic.biz/NMObjects/
 * Description: A Charting and Interface Package
 * Version: 4.75
 * Author: Neil Oman
 * Author URI: http://www.nomanic.biz/
 * License: Envato Split License with GPL (see text file)
 *
 * Copyright 2018  Nomanic  (email : nomanic99@gmail.com)
 *
 * Basically free for non-commercial use only.
 * If you wish to buy a license, please visit my website.
 */
"use strict";var NomanicGraph={prop:.95,ref:"child",drawcaps:function(t,e,a,o,l,s,c,r){t.ctx.save();var i,n,p,h=t.layout.vertical,d=Math.floor(5/766*t.objects.canvas.offsetHeight*2),g=c||d,b=g/4,f=(d=d-g/2)+g/2;d=d>0?d:0;var m=1.1*(c?f:2*g)-(c?f:2*g);for(m=m<2?2:m,t.ctx.fillStyle=r||t.legend.ncolors[t.cs][s],t.ctx.beginPath(),i=0;i<l.length;i+=2)switch(n=h?l[i+1]:l[i]+a,p=h?l[i]+a:l[i+1],i!=l.length-2||a||e||(h?p=t.objects.panel.offsetHeight:n=t.objects.panel.offsetWidth),t.ctx.moveTo(n,p),o){case 1:t.ctx.arc(n,p,c?f:2*g,0,NomanicObject.Pi2,!0),t.ctx.arc(n,p,c?d:g,0,NomanicObject.Pi2,!1),t.ctx.fill(),t.ctx.closePath();break;case 2:t.ctx.arc(n,p,c?f:2*g,0,NomanicObject.Pi2,!0),t.ctx.moveTo(n=h?l[i+1]:l[i],p=h?l[i]:l[i+1]),t.ctx.arc(n,p,c?1.8*f:3.6*g,0,NomanicObject.Pi2,!0),t.ctx.arc(n,p,c?1.3*f:2.6*g,0,NomanicObject.Pi2,!1),t.ctx.fill(),t.ctx.closePath();break;case 3:t.ctx.arc(n,p,c?f:2*g,0,NomanicObject.Pi2,!0),t.ctx.fill(),t.ctx.closePath();break;case 4:t.ctx.fillStyle="#FFF",t.ctx.arc(n,p,(c?f:2*g)+m,0,NomanicObject.Pi2,!0),t.ctx.fill(),t.ctx.closePath();break;case 6:t.ctx.beginPath(),t.ctx.fillStyle=r||t.legend.ncolors[t.cs][s],t.ctx.arc(n,p,c?f:2*g,0,NomanicObject.Pi2,!0),t.ctx.fill(),t.ctx.closePath();break;case 5:t.ctx.shadowOffsetX=b,t.ctx.shadowOffsetY=b,t.ctx.shadowBlur=b+b,t.ctx.shadowColor="black",t.ctx.fillStyle="#FFF",t.ctx.arc(n,p,(c?f:2*g)+m,0,NomanicObject.Pi2,!0),t.ctx.fill(),t.ctx.closePath();break;case 7:t.ctx.beginPath(),t.ctx.fillStyle=r||t.legend.ncolors[t.cs][s],t.ctx.arc(n,p,c?f:2*g,0,NomanicObject.Pi2,!0),t.ctx.fill(),t.ctx.closePath()}t.ctx.restore()},lkfeel:function(t,e){var a,o;t.objects.div.getElementsByClassName("tbar")[0];return a=e.plot?e.plot:{},o=e.chart?e.chart:{},e.background?e.background:{},e.frame?e.frame:{},a.color&&(t.plot.color=a.color,NomanicGraph.buildlegend(t,t.cs,t.plot.data,!1,1)),a.linecolors&&NomanicGraph.buildlegend(t,t.cs,t.plot.data,a.linecolors,1),(a.neon||0===a.neon)&&(t.plot.neon=a.neon,t.plot.neon?(t.objects.div.style.textShadow="0 0 30px "+t.layout.pencil.nink,t.objects.graph.style.textShadow="0 0 30px "+(t.layout.chart.nink?t.layout.chart.nink:t.layout.pencil.nink)):(t.objects.div.style.textShadow=null,t.objects.graph.style.textShadow=null)),(a.opacityspread||0===a.opacityspread)&&(t.plot.opacityspread=a.opacityspread),o.image&&(t.objects.graph.style.backgroundImage=NomanicObject.lazyload(t.objects.graph,o.image)),o.color&&(t.objects.graph.style.backgroundColor=o.color),o.ink&&t.setcink(ccol),o.grid&&t.setgink(gcol),(o.border||0===o.border)&&(t.layout.showchartborder=o.border),t.rsr(t),t},drawlegend:function(t,e,a,o,l,s){e.style.border=null,e.style.backgroundColor=null,NomanicObject.addClass(e,"done");var c,r,i,n,p,h=e.offsetWidth;if(e.innerHTML='<canvas width="'+h+'" height="'+h+'"></canvas>',(n=e.children[0].getContext("2d")).translate(.5,.5),n.save(),n.strokeStyle=s,n.fillStyle=s,n.lineWidth=h/8,a)for(t.plot.opacityspread&&t.plot.color?(r=NomanicObject.hexToRgb(t.plot.color),p=.2):(r=NomanicObject.hexToRgb(s),p=.2),i=5;i>=0;i--)n.strokeStyle=0===i?"#fff":"rgba("+r[0]+","+r[1]+","+r[2]+","+p+")",n.beginPath(),o&&n.setLineDash([h/3,h/3]),n.lineWidth=0==(c=h/2*(i/5))?1:c,n.moveTo(0,h/2),n.lineTo(h,h/2),n.stroke(),n.closePath(),l&&(n.beginPath(),n.moveTo(h/2,h/2),n.arc(h/2,h/2,h/4,0,2*Math.PI,!1),n.closePath(),n.stroke(),n.beginPath(),n.fillStyle=t.layout.background.color,n.moveTo(h/2,h/2),n.arc(h/2,h/2,h/8,0,2*Math.PI,!1),n.closePath(),n.stroke());else n.beginPath(),o&&n.setLineDash([h/3,h/3]),n.moveTo(0,h/2),n.lineTo(h,h/2),n.stroke(),n.closePath(),l&&(n.beginPath(),n.moveTo(h/2,h/2),n.arc(h/2,h/2,h/4,0,2*Math.PI,!1),n.closePath(),n.fill(),n.beginPath(),n.fillStyle=t.layout.background.color,n.moveTo(h/2,h/2),n.arc(h/2,h/2,h/8,0,2*Math.PI,!1),n.closePath(),n.fill());n.restore()},drawmarker:function(t){t.ctx.save();var e="line"==t.layout.type,a=t.layout.chart.nink?t.layout.chart.nink:t.layout.background.nink;t.ctx.fillStyle=a,t.ctx.beginPath(),t.plot.neon&&(t.ctx.shadowBlur=40,t.ctx.shadowColor=a),t.layout.vertical?(t.ctx.moveTo(t.objects.canvas.offsetWidth-3,t.selx*t.bw-(e?.5*t.bw:0)+.2*t.bw),t.ctx.lineTo(t.objects.canvas.offsetWidth-3-.15*t.bw,(t.selx+.5)*t.bw-(e?.5*t.bw:0)),t.ctx.lineTo(t.objects.canvas.offsetWidth-3,(t.selx+1)*t.bw-(e?.5*t.bw:0)-.2*t.bw)):(t.ctx.moveTo(t.selx*t.bw-(e?.5*t.bw:0)+.2*t.bw,3),t.ctx.lineTo((t.selx+.5)*t.bw-(e?.5*t.bw:0),3+.15*t.bw),t.ctx.lineTo((t.selx+1)*t.bw-(e?.5*t.bw:0)-.2*t.bw,3)),t.ctx.fill(),t.ctx.closePath(),t.ctx.restore()},NMCdrawPolarLine:function(t,e){if(t.objects){var a,o,l,s,c,r,i,n,p,h,d,g,b,f,m,u,x,y=0,N=e,j=Math.floor(15/766*t.objects.graph.offsetHeight),w=Math.floor(j/3),v=t.objects.canvas.offsetHeight,k=t.objects.canvas.offsetWidth,O=v*t.plot.donuty,M=k*t.plot.donuty,G=(Math.floor(Math.abs(O/200*10*(1-M/O))),Math.floor(O/2)),P=Math.floor(M/2),T=Math.floor(k/2),C=Math.floor(v/2),S=-NomanicObject.PiHalf,H=Math.sin(0*Math.PI),z=Math.cos(0*Math.PI),W=P<G?P:G;for(t.cx=T,t.cy=C,l=t.plot.data.length,t.ctx.restore(),t.ctx.save(),h=0;h<N.length;h++)if(1==t.legend.inuse[t.cs][l+h]&&N[h].fill){for(d=[],x=N[h].series.length,p=0;p<x;p++)m=(o=N[h].series[p]/t.absmax*W)*Math.cos(a=(p+.5)/x*NomanicObject.Pi2+S),d.push(T-(u=o*Math.sin(a))*H+m*z),d.push(C+m*H+u*z);for(g=N[h].spline?NomanicGraph.getCurvePoints(d):d,t.ctx.beginPath(),t.ctx.moveTo(s=g[0],c=g[1]),p=0;p<g.length;p+=2)t.ctx.lineTo(g[p],g[p+1]);if(t.ctx.lineTo(s,c),t.plot.opacityspread&&t.plot.color&&0===l){var I=.8/N.length;b=NomanicObject.hexToRgb(t.plot.color),f=1-I*h}else b=NomanicObject.hexToRgb(t.legend.ncolors[t.cs][l+h]),f=1;var A=t.pattern[l+h]?t.ctx.createPattern(t.pattern[l+h],"repeat"):"rgba("+b[0]+","+b[1]+","+b[2]+","+(N[h].alpha?N[h].alpha*f:f)+")";if(t.ctx.fillStyle=A,t.ctx.fill(),t.ctx.closePath(),t.plot.hint){for(t.ctx.beginPath(),t.ctx.moveTo(s=g[0],c=g[1]),p=0;p<g.length;p+=2)t.ctx.lineTo(g[p],g[p+1]);t.ctx.lineTo(s,c),t.ctx.fillStyle=t.hintfill,t.ctx.fill(),t.ctx.closePath()}}for(t.ctx.restore(),t.ctx.save(),t.ctx.lineWidth=j/2,h=0;h<N.length;h++)if(1==t.legend.inuse[t.cs][l+h]){for(d=[],i=0,x=N[h].series.length,p=0;p<x;p++)m=(o=N[h].series[p]/t.absmax*W)*Math.cos(a=(p+.5)/x*NomanicObject.Pi2+S),u=u=o*Math.sin(a),d.push(T-u*H+m*z),d.push(C+m*H+u*z);t.plot.shadow&&(t.ctx.shadowOffsetX=w,t.ctx.shadowOffsetY=w,t.ctx.shadowBlur=w+w,t.ctx.shadowColor="black"),t.ctx.strokeStyle=t.legend.ncolors[t.cs][l+h];y=0;d.push(d[0],d[1]),g=!N[h].spline||N[h].cap&&!N[h].neon?d:NomanicGraph.getCurvePoints(d),t.ctx.save(),N[h].dashed?t.ctx.setLineDash([15,15]):t.ctx.setLineDash([]);var F=y?t.wbw/2:0;if(N[h].neon){if(t.plot.opacityspread&&t.plot.color&&0===l){I=.8/N.length;L=NomanicObject.hexToRgb(t.plot.color),f=.2*(1-I*h)}else{var L=NomanicObject.hexToRgb(t.legend.ncolors[t.cs][l+h]);f=.2}for(r=5;r>=0;r--){for(t.ctx.strokeStyle=0===r?"#fff":"rgba("+L[0]+","+L[1]+","+L[2]+","+f+")",t.ctx.lineCap="round",t.ctx.beginPath(),t.ctx.lineWidth=4*(r+1)-2,t.ctx.moveTo(g[0]+F,g[1]),p=2;p<g.length-(y?2:0);p+=2)i=g[p]+F,n=g[p+1],t.ctx.lineTo(i,n);t.ctx.stroke(),t.ctx.closePath(),NomanicGraph.drawcaps(t,1,F,N[h].cap,d,l+h,F),N[h].cap>3&&NomanicGraph.drawcaps(t,1,F,N[h].cap+2,d,l+h,F)}}else if(t.ctx.strokeStyle=t.legend.ncolors[t.cs][l+h],N[h].cap){g=NomanicGraph.avoid(g,d,Math.floor(5/766*t.objects.canvas.offsetHeight*2));var q=[];for(r=0;r<g.length;r++)for(q[r]=[],q[r].push([g[r][0]+F,g[r][1]]),p=2;p<g[r].length;p+=2)i=g[r][p]+F,n=g[r][p+1],q[r].push([i,n]);for(p=0;p<q.length;p++){for(t.ctx.beginPath(),t.ctx.moveTo(q[p][0][0],q[p][0][1]),i=1;i<q[p].length;i++)t.ctx.lineTo(q[p][i][0],q[p][i][1]);t.ctx.stroke(),t.ctx.closePath()}NomanicGraph.drawcaps(t,1,F,N[h].cap,d,l+h,F),N[h].cap>3&&NomanicGraph.drawcaps(t,1,F,N[h].cap+2,d,l+h,F)}else{for(t.ctx.beginPath(),t.ctx.moveTo(g[0]+F,g[1]),p=2;p<g.length-(y?2:0);p+=2)i=g[p]+F,n=g[p+1],t.ctx.lineTo(i,n);t.ctx.stroke(),t.ctx.closePath()}t.ctx.restore(),t.ctx.save(),t.layout.showlegend&&NomanicGraph.drawlegend(t,t.objects.legend.children[0].children[l+h].children[1],N[h].neon?1:0,N[h].dashed?1:0,N[h].cap?1:0,t.legend.ncolors[t.cs][l+h])}return t.ctx.restore(),t.ctx.save(),t}},polargrid:function(t,e,a,o,l){if(t.objects){var s,c,r,i=t.objects.canvas.offsetHeight,n=t.objects.canvas.offsetWidth,p=i*t.plot.donuty,h=n*t.plot.donuty,d=(Math.floor(Math.abs(p/200*10*(1-h/p))),Math.floor(p/2)),g=Math.floor(h/2),b=Math.floor(n/2),f=Math.floor(i/2),m=-NomanicObject.PiHalf,u=Math.sin(0*Math.PI),x=Math.cos(0*Math.PI),y=g<d?g:d,N=t.plot.data[0]?t.plot.data[0].series.length:t.plot.lines[0].series.length;for(t.ctx.strokeStyle=l,t.plot.neon&&(t.ctx.shadowBlur=40,t.ctx.shadowColor=l),r=0;r<a+1;r+=t.tick)t.ctx.beginPath(),t.ctx.arc(b,f,r/a*y,0,NomanicObject.Pi2),t.ctx.stroke(),t.ctx.closePath();for(r=0;r<1;r+=1/N)t.ctx.beginPath(),t.ctx.moveTo(b,f),t.ctx.lineTo(b-(c=y*Math.sin(r*NomanicObject.Pi2+m))*u+(s=y*Math.cos(r*NomanicObject.Pi2+m))*x,f+s*u+c*x),t.ctx.stroke(),t.ctx.closePath();if(t.plot.marker){t.ctx.save(),r=(t.selx+.3)/N;var j=(t.selx+.5)/N,w=(t.selx+.7)/N,v=1.14*(b-(c=y*Math.sin(r*NomanicObject.Pi2+m))*u+(s=y*Math.cos(r*NomanicObject.Pi2+m))*x-b)+b,k=1.14*(f+s*u+c*x-f)+f,O=1.08*(b-(c=y*Math.sin(j*NomanicObject.Pi2+m))*u+(s=y*Math.cos(j*NomanicObject.Pi2+m))*x-b)+b,M=1.08*(f+s*u+c*x-f)+f,G=1.14*(b-(c=y*Math.sin(w*NomanicObject.Pi2+m))*u+(s=y*Math.cos(w*NomanicObject.Pi2+m))*x-b)+b,P=1.14*(f+s*u+c*x-f)+f;t.ctx.beginPath(),l=t.layout.chart.nink?t.layout.chart.nink:t.layout.background.nink,t.ctx.fillStyle=l,t.plot.neon&&(t.ctx.shadowBlur=40,t.ctx.shadowColor=l),t.ctx.moveTo(v,k),t.ctx.lineTo(O,M),t.ctx.lineTo(G,P),t.ctx.lineTo(v,k),t.ctx.fill(),t.ctx.closePath(),t.ctx.restore()}}},polarslice:function(t,e,a,o,l,s,c,r,i,n,p){if(t.objects){if(t.plot.round&&!p){var h=1/t.plot.round;e=Math.round(e/h)*h,a=Math.round(a/h)*h}var d,g,b;if(t.plot.band&&!p){for(d=0;d<t.plot.band.length;d+=2)e>=.999999999*t.plot.band[d]&&(g=g||0===g?g:d/2),a<=.999999999*t.plot.band[d]&&(b=b||0===b?b:d/2);if(g==b)c=t.plot.band[g+1],NomanicGraph.bpolarslice(t,e,a,o,l,s,c,r,i,n,p);else for(var f,m=a,u=g;e<m;)e>=.999999999*t.plot.band[u+2]&&(u+=2),c=t.plot.band[u+1],a=(f=.999999999*t.plot.band[u+=2])>m?m:f,NomanicGraph.bpolarslice(t,e,a,o,l,s,c,r,i,n,p),e=a}else NomanicGraph.bpolarslice(t,e,a,o,l,s,c,r,i,n,p)}},bpolarslice:function(t,e,a,o,l,s,c,r,i,n,p){if(t.plot.roundgap&&!p){var h,d=e,g=a,b=1/t.plot.round;for(h=d;h<g;h+=b)a=(e=h)+b*t.plot.roundgap,NomanicGraph.dpolarslice(t,e,a,o,l,s,c,r,i,n)}else NomanicGraph.dpolarslice(t,e,a,o,l,s,c,r,i,n)},dpolarslice:function(t,e,a,o,l,s,c,r,i,n){var p=l,h=s,d=e,g=a;if(1!=r&&(a=a>1?1:a,e=e<0?0:e),!t.seg&&0!==t.seg||-1==t.seg||t.egg3||t.egg2){if(-1==t.seg){var b=.1*(a-e);l=(f=l)+.1*(m=s-l),s=f+.9*m,t.s2=t.s2?t.s2:b,a-=t.s2,e+=t.s2}}else{var f,m=s-l;l=(f=l)+t.plot.data[t.seg].idonut*m,s=f+t.plot.data[t.seg].odonut*m}var u,x,y,N,j,w,v,k,O=t.objects.canvas.offsetHeight,M=t.objects.canvas.offsetWidth,G=O*t.plot.scalary,P=M*t.plot.scalarx,T=(Math.floor(Math.abs(G/200*10*(1-P/G))),Math.floor(G/2)),C=Math.floor(P/2),S=Math.floor(M/2),H=Math.floor(O/2),z=-NomanicObject.PiHalf,W=Math.sin(0*Math.PI),I=Math.cos(0*Math.PI);e=1==r?e*Math.PI-NomanicObject.PiHalf:2==r?.85*e*NomanicObject.Pi2+NomanicObject.PiHalf:e*NomanicObject.Pi2;var A=((a=1==r?a*Math.PI-NomanicObject.PiHalf:2==r?.85*a*NomanicObject.Pi2+NomanicObject.PiHalf:a*NomanicObject.Pi2)+e)/2;1==r?(H=.9*O,x=u=C<.9*G?C:.9*G):1!==t.plot.egg?x=u=C<T?C:T:(u=T,x=C),S+=(y=t.plot.seperate*Math.cos(A+z))*I-(N=t.plot.seperate*Math.sin(A+z))*W,H+=y*W+N*I,t.ctx.beginPath();var F,L=u*s,q=[],R=[],Y=x*s,D=u*l,V=x*l;for(R.push(0),w=e;w<a;w+=.01)q.push(S-(N=L*Math.sin(w+z))*W+(y=Y*Math.cos(w+z))*I),q.push(H+o+y*W+N*I);for(R.push(q.length-2),R.push(q.length),w=a;w>e;w-=.01)q.push(S-(N=D*Math.sin(w+z))*W+(y=V*Math.cos(w+z))*I),q.push(H+o+y*W+N*I);if(R.push(q.length-2),t.ctx.save(),t.ctx.beginPath(),NomanicGraph.drawArc(t,q,g-d,0),2!=r||0!==d||!t.seg&&0!==t.seg||-1==t.seg||t.plot.data[t.seg].icon&&((j=t.objects.mask.children[1].children[t.seg].style).top=k-1.4*(v-F)+"px",j.left=F+"px",j.width=v-F+"px",j.height=v-F+"px"),t.plot.neon&&(t.ctx.shadowBlur=40,t.ctx.shadowColor=c),t.ctx.fillStyle=c,t.ctx.fill(),t.ctx.closePath(),t.ctx.fillStyle="#454545",t.plot.egg)for(w=0;w<R.length;w++)t.ctx.fillRect(q[R[w]],q[R[w]+1],1,1);if(-1==t.seg?(t.ctx.beginPath(),NomanicGraph.drawArc(t,q,g-d,0),t.ctx.fillStyle="rgba(255,255,255,0.3)",t.ctx.fill(),t.ctx.closePath()):n&&(t.ctx.beginPath(),NomanicGraph.drawArc(t,q,g-d,0),t.ctx.fillStyle="rgba(0,0,0,"+n+")",t.ctx.fill(),t.ctx.closePath()),t.plot.outline&&i&&!t.noedge&&(t.ctx.strokeStyle="#454545",t.ctx.beginPath(),NomanicGraph.drawArc(t,q,g-d,0),t.ctx.stroke(),t.ctx.closePath()),t.ctx.restore(),-1==t.seg&&t.plot.shadow){for(t.ctx.save(),t.ctx.beginPath(),t.ctx.moveTo(v=q[0],k=q[1]),w=0;w<q.length;w+=2)t.ctx.lineTo(q[w],q[w+1]);for(t.ctx.lineTo(v,k),t.ctx.clip(),t.ctx.closePath(),o=0;o<6;o++)t.ctx.strokeStyle="rgba(69,69,69,"+shd(o/6)+")",t.ctx.beginPath(),NomanicGraph.drawArc(t,q,g-d,o),t.ctx.stroke(),t.ctx.closePath();t.ctx.restore()}else if(t.plot.shadow){for(t.ctx.save(),t.ctx.beginPath(),t.ctx.moveTo(v=q[0],k=q[1]),w=0;w<q.length;w+=2)t.ctx.lineTo(q[w],q[w+1]);for(t.ctx.lineTo(v,k),t.ctx.clip(),t.ctx.closePath(),o=0;o<6;o++)t.ctx.strokeStyle="rgba(69,69,69,"+NomanicObject.shd(o/6)+")",t.ctx.beginPath(),NomanicGraph.drawArc(t,q,g-d,o),t.ctx.stroke(),t.ctx.closePath();t.ctx.restore()}t.plot.hint&&!t.egg3&&(t.ctx.save(),t.ctx.beginPath(),NomanicGraph.drawArc(t,q,a-e,0),t.ctx.fillStyle=t.hintfill,t.ctx.fill(),t.ctx.closePath(),t.ctx.restore()),t.plot.inset&&(t.seg||0===t.seg)&&-1!=t.seg&&(t.seg=-1,NomanicGraph.dpolarslice(t,d,g,o,p,h,c,r,i,n))},drawArc:function(t,e,a,o){var l,s,c,r;if(1!=a){for(t.ctx.moveTo(s=e[0]+o,c=e[1]+o),l=0;l<e.length;l+=2)t.ctx.lineTo(e[l]+o,e[l+1]+o);t.ctx.lineTo(s,c)}else{for(t.ctx.moveTo(s=e[0]+o,c=e[1]+o),l=0;l<e.length/2;l+=2)t.ctx.lineTo(e[l]+o,e[l+1]+o);for(r=e.length/2,t.ctx.moveTo(s=e[r]+o,c=e[r+1]+o),l=r;l<e.length;l+=2)t.ctx.lineTo(e[l]+o,e[l+1]+o)}},NMCdrawHalfPie:function(t,e,a){var o,l,s,c=t.plot.data,r=0,i=[],n=[],p=t.objects.canvas.offsetHeight,h=t.objects.canvas.offsetWidth,d=p*t.plot.scalary,g=h*t.plot.scalarx,b=-Math.abs((1-t.plot.scalary)*d)/2,f=Math.abs((1-t.plot.scalarx)*g)/2;Math.floor(Math.abs(d/200*10*(1-g/d)));for(t.gw=t.gw?t.gw:-1,t.gh=t.gh?t.gh:-1,p==t.gh&&h==t.gw||(t.hintfill=t.ctx.createLinearGradient(0,0,h,p),t.hintfill.addColorStop(0,"rgba(0,0,0,0)"),t.hintfill.addColorStop(1,"rgba(0,0,0,0.4)")),t.ctx.clearRect(0,0,t.objects.panel.offsetWidth,t.objects.panel.offsetHeight),NomanicGraph.doborder(t,f,b,h,p,a),o=0;o<c.length;o++)r+=1==t.legend.inuse[t.cs][o]?c[o].series[0]:0;for(o=0;o<c.length;o++)t.plot.data[o].totals[t.selx]=r;for(i.push(0),o=0;o<c.length;o++)1==t.legend.inuse[t.cs][o]&&(i.push(c[o].series[0]/r),n.push(o));for(t.ctx.restore(),t.ctx.save(),r=0,o=0;o<i.length;o++)i[o]=o==i.length-1?Math.round(100*(1-r))/100:parseInt(100*i[o])/100,r+=i[o];s=0;var m=t.plot.shadow,u=(t.plot.donuty,t.plot.donut,i.length,t.plot.outerring?t.plot.donuty-.15:t.plot.donuty);for(o=1;o<i.length;o++){if(l=s+i[o],s=s<0?0:s,l=l>1?1:l,t.pattern[o-1])N=t.ctx.createPattern(t.pattern[o-1],"repeat");else if(t.plot.opacityspread&&t.plot.color)var x=.8/c.length,y=NomanicObject.hexToRgb(t.plot.color),N="rgba("+y[0]+","+y[1]+","+y[2]+","+(1-x*(o-1))+")";else N=t.legend.ncolors[t.cs][n[o-1]];var j=t.plot.donut+(u-t.plot.donut)*t.plot.data[o-1].idonut,w=t.plot.donut+(u-t.plot.donut)*t.plot.data[o-1].odonut,v=t.plot.egg2||0===t.plot.egg2?t.plot.egg2:j,k=t.plot.egg3?t.plot.egg3:w;if(k>1){v/=k,j/=k,w/=k,k/=k}t.plot.shadow=0,t.egg3=1,(t.plot.egg2||0===t.plot.egg2)&&(t.seg=o-1,t.plot.eggcol2?NomanicGraph.polarslice(t,0,1,0,v,j,t.plot.eggcol2,1,1,t.plot.eggshade2):t.plot.eggcol2||NomanicGraph.polarslice(t,s,l,0,v,j,N,1,1,t.plot.eggshade2),t.seg=!1),t.egg2=1,t.egg3=!1,t.seg=o-1,t.plot.shadow=m,NomanicGraph.polarslice(t,s,l,0,j,w,N,1,1),t.plot.shadow=0,t.seg=!1,t.egg3=1,t.egg2=!1,t.plot.egg3&&(t.plot.eggcol3?NomanicGraph.polarslice(t,0,1,0,w,k,t.plot.eggcol3,1,1,t.plot.eggshade3):t.plot.eggcol3||NomanicGraph.polarslice(t,s,l,0,w,k,N,1,1,t.plot.eggshade3)),t.plot.innerring&&t.plot.donut>0&&(t.seg=o-1,NomanicGraph.polarslice(t,s,l,0,t.plot.donut-.17,t.plot.donut-.085,N,1,1),t.seg=!1),t.plot.outerring&&(t.seg=o-1,NomanicGraph.polarslice(t,s,l,0,t.plot.donuty-.085,t.plot.donuty,N,1,1),t.seg=!1),t.egg3=!1,t.plot.shadow=m,s=l,t.ctx.restore(),t.ctx.save()}return t.showdata(t),t},NMCdrawPie:function(t,e,a){var o,l=0,s=t.plot.data;for(o=0;o<s.length;o++)1==t.legend.inuse[t.cs][o]&&l++;var c,r,i,n=0,p=[],h=[],d=t.objects.canvas.offsetHeight,g=t.objects.canvas.offsetWidth,b=d*t.plot.scalary,f=g*t.plot.scalarx,m=-Math.abs((1-t.plot.scalary)*b)/2,u=Math.abs((1-t.plot.scalarx)*f)/2,x=Math.floor(Math.abs(b/200*10*(1-f/b)));for(t.gw=t.gw?t.gw:-1,t.gh=t.gh?t.gh:-1,d==t.gh&&g==t.gw||(t.hintfill=t.ctx.createLinearGradient(0,0,g,d),t.hintfill.addColorStop(0,"rgba(0,0,0,0)"),t.hintfill.addColorStop(1,"rgba(0,0,0,0.4)")),t.ctx.clearRect(0,0,t.objects.panel.offsetWidth,t.objects.panel.offsetHeight),NomanicGraph.doborder(t,u,m,g,d,a),t.plot.egg||(x=0),o=0;o<s.length;o++)n+=1==t.legend.inuse[t.cs][o]?s[o].series[0]:0;if(e)n=n>t.plot.data[0].totals[t.selx]?n:t.plot.data[0].totals[t.selx];else for(o=0;o<s.length;o++)t.plot.data[o].totals[t.selx]=n;for(p.push(0),o=0;o<s.length;o++)1==t.legend.inuse[t.cs][o]&&(p.push(s[o].series[0]/n),h.push(o));for(t.ctx.restore(),t.ctx.save(),n=0,o=0;o<p.length;o++)p[o]=o==p.length-1?e?parseInt(100*p[o])/100:Math.round(100*(1-n))/100:parseInt(100*p[o])/100,n+=p[o];var y=t.plot.shadow,N=(t.plot.donuty,t.plot.donut,p.length,t.plot.outerring?t.plot.donuty-.15:t.plot.donuty);for(t.egg2=!1,i=x;i>-(t.plot.stacked?5*l:1);i--)for(r=0,o=1;o<p.length;o++)if(!t.plot.stacked||i>-5*(l-(o-1))){c=(c=r+p[o])>1?1:c;var j=0;if(t.plot.egg&&(j=t.plot.stacked?i>-5*(l-(o-1))+1?1:0:i>0),t.pattern[o-1])k=t.ctx.createPattern(t.pattern[o-1],"repeat");else if(t.plot.opacityspread&&t.plot.color)var w=.8/s.length,v=NomanicObject.hexToRgb(j?NomanicObject.lighten(t.plot.color,-.3):t.plot.color),k="rgba("+v[0]+","+v[1]+","+v[2]+","+(1-w*(o-1))+")";else k=j?NomanicObject.lighten(t.legend.ncolors[t.cs][h[o-1]],-.3):t.legend.ncolors[t.cs][h[o-1]];var O=t.plot.donut+(N-t.plot.donut)*t.plot.data[o-1].idonut,M=t.plot.donut+(N-t.plot.donut)*t.plot.data[o-1].odonut,G=t.plot.egg2||0===t.plot.egg2?t.plot.egg2:O,P=t.plot.egg3?t.plot.egg3:M;if(P>1){G/=P,O/=P,M/=P,P/=P}t.plot.shadow=0,t.egg3=1,(t.plot.egg2||0===t.plot.egg2)&&(t.seg=o-1,t.plot.eggcol2?NomanicGraph.polarslice(t,0,1,i,G,O,t.plot.eggcol2,0,1,t.plot.eggshade2):t.plot.eggcol2||NomanicGraph.polarslice(t,r,c,i,G,O,k,0,1,t.plot.eggshade2),t.seg=!1),t.egg2=1,t.egg3=!1,t.noedge=i==x||(t.plot.stacked?i==-5*(l-(o-1))+1:0===i)?0:1,t.seg=o-1,t.plot.shadow=y,NomanicGraph.polarslice(t,r,c,i,O,M,k,0,1),t.plot.shadow=0,t.seg=!1,t.egg2=!1,t.egg3=1,t.plot.egg3&&(t.plot.eggcol3?NomanicGraph.polarslice(t,0,1,i,M,P,t.plot.eggcol3,0,1,t.plot.eggshade3):t.plot.eggcol3||NomanicGraph.polarslice(t,r,c,i,M,P,k,0,1,t.plot.eggshade3)),t.plot.innerring&&t.plot.donut>0&&(t.seg=o-1,NomanicGraph.polarslice(t,r,c,i,t.plot.donut-.17,t.plot.donut-.085,k,0,1),t.seg=!1),t.plot.outerring&&(t.seg=o-1,NomanicGraph.polarslice(t,r,c,i,t.plot.donuty-.085,t.plot.donuty,k,0,1),t.seg=!1),t.plot.shadow=y,t.egg3=!1,r=c,t.ctx.restore(),t.ctx.save()}return t.showdata(t),t},NMCdrawPolar:function(t){t.ctx.save();var e,a,o,l,s,c=t.plot.data,r=c[0]?c[0].series.length:0,i=[],n=[],p=t.objects.graph.offsetHeight,h=t.objects.graph.offsetWidth,d=p*t.plot.donuty,g=h*t.plot.donuty,b=-Math.abs((1-t.plot.scalary)*d)/2,f=Math.abs((1-t.plot.scalarx)*g)/2,m=(t.layout.vertical,0);for(t.gw=t.gw?t.gw:-1,t.gh=t.gh?t.gh:-1,p==t.gh&&h==t.gw||(t.hintfill=t.ctx.createLinearGradient(0,0,h,p),t.hintfill.addColorStop(0,"rgba(0,0,0,0)"),t.hintfill.addColorStop(1,"rgba(0,0,0,0.4)")),t.ctx.clearRect(0,0,t.objects.panel.offsetWidth,t.objects.panel.offsetHeight),NomanicGraph.doborder(t,f,b,h,p),t.layout.showgrid&&NomanicGraph.polargrid(t,t.tick,t.absmax,1/r,t.layout.chart.gridcolor),1/r,s=0;s<r;s++){for(0,m=0,a=s/r,o=(s+1)/r,l=0;l<c.length;l++)if(1==t.legend.inuse[t.cs][l]){var u=c[l].series[s],x=m/t.absmax,y=(m+u)/t.absmax;m+=u,e=t.selx===s&&t.plot.highlight?c[l].high:t.legend.ncolors[t.cs][l],t.seg=l,NomanicGraph.polarslice(t,a,o,0,x*t.plot.donuty,y*t.plot.donuty,e,!1,1),t.seg=!1}n.push(m),i.push(m/2)}if(t.plot.lines){for(l=0;l<t.plot.lines.length;l++)t.plot.lines[l].average&&(t.plot.lines[l].series=i),t.plot.lines[l].sum&&(t.plot.lines[l].series=n);t=NomanicGraph.NMCdrawPolarLine(t,t.plot.lines)}return t},drawRect:function(t,e,a,o,l,s){switch(e=t.plot.stacked?0:e){case 0:t.ctx.fillRect(a,o,l,s);break;case 1:t.ctx.beginPath(),t.ctx.moveTo(a,o+s),t.ctx.lineTo(a+.5*l,o),t.ctx.lineTo(a+l,o+s),t.ctx.lineTo(a,o+s),t.ctx.fill(),t.ctx.closePath();break;case 2:new NomanicGraph.Gaussian(0,1).draw(t,a,o,l,s)}return e},NMCdrawBar:function(t,e,a){NomanicGraph.doscale(t,1),t.wbw=t.bw,t.ctx.save();var o,l,s,c,r,i=[],n=[],p=0,h=0,d=t.plot.data,g=d.length,b=t.objects.graph.offsetWidth,f=t.objects.graph.offsetHeight,m=-Math.abs((1-t.plot.scalary)*f)/2,u=Math.abs((1-t.plot.scalarx)*b)/2,x=t.layout.vertical,y=0,N=0;for(t.gw=t.gw?t.gw:-1,t.gh=t.gh?t.gh:-1,f==t.gh&&b==t.gw||(t.hintfill=t.ctx.createLinearGradient(0,0,b,f),t.hintfill.addColorStop(0,"rgba(0,0,0,0)"),t.hintfill.addColorStop(1,"rgba(0,0,0,0.4)")),t.ctx.clearRect(0,0,t.objects.panel.offsetWidth,t.objects.panel.offsetHeight),t.layout.showgrid&&NomanicGraph.plotgrid(t),NomanicGraph.plotgrid(t),!a&&t.layout.border&&(t.ctx.beginPath(),t.ctx.linewidth=1,t.ctx.strokeStyle=t.layout.chart.gridcolor,t.ctx.rect(0,0,t.objects.panel.offsetWidth-1,t.objects.panel.offsetHeight-1),t.ctx.stroke(),t.ctx.closePath()),NomanicGraph.doborder(t,u,m,b,f,a),t.bw=(x?f*t.plot.scalary:b*t.plot.scalarx)/t.barspp,t.legend.heights=[],o=0;o<d.length;o++)t.legend.heights[o]=[];for(c="s",l=0;l<d[0].series.length;l++){for(p=NomanicObject.converth(N,x?0:f,x?b:0,t.absmin,t.absmax),h=NomanicObject.converth(y,x?0:f,x?b:0,t.absmin,t.absmax),NomanicObject.converth(0,x?0:f,x?b:0,t.absmin,t.absmax),N=0,y=0,o=0;o<d.length;o++)if(1==t.legend.inuse[t.cs][o]){s=d[o].cap?d[o].cap:0,t.plot.stacked||(N=0,y=0,p=NomanicObject.converth(N,x?0:f,x?b:0,t.absmin,t.absmax),h=NomanicObject.converth(y,x?0:f,x?b:0,t.absmin,t.absmax));var j,w,v=d[o].series[l],k=v>0?y:N,O=NomanicObject.converth(v+k,x?0:f,x?b:0,t.absmin,t.absmax)+(v+k>0?1:-1)*(t.plot.seperate?t.plot.seperate:0),M=NomanicObject.converth(v>0?y:N,x?0:f,x?b:0,t.absmin,t.absmax)-O;t.plot.stacked?(j=t.bw-(t.plot.seperatex?t.plot.seperatex:2),w=t.bw*l):(j=t.bw/g-(t.plot.seperatex?t.plot.seperatex:2),w=t.bw*l+o*(t.bw/g));var G=t.pattern[o]?t.ctx.createPattern(t.pattern[o],"repeat"):t.selx===l&&t.plot.highlight?d[o].high:t.legend.ncolors[t.cs][o];1!=(r=d[o].alpha?d[o].alpha:1)&&(t.ctx.globalAlpha=r),t.ctx.fillStyle=G,t.ctx.save(),(t.plot.neon||d[o].neon)&&(t.ctx.shadowBlur=40,t.ctx.shadowColor=G);var P=(x?O:w)+u,T=NomanicGraph.frm(x?w:O,f,t.plot.scalary,m),C=x?M*t.plot.scalary:j,S=x?j:M*t.plot.scalary;if(s=NomanicGraph.drawRect(t,s,P,T,C,S),t.ctx.globalAlpha=1,t.ctx.restore(),t.legend.heights[o].push([w+j/2+u,NomanicGraph.frm(O,f,t.plot.scalary,m),w>.5*b?1:0]),t.plot.hint&&(isNaN(w)||(t.ctx.fillStyle=t.hintfill,NomanicGraph.drawRect(t,s,P,T,C,S))),t.plot.outline&&0===s&&(t.ctx.lineWidth=1,t.ctx.strokeStyle="#454545",t.ctx.strokeRect(P,T,C,S)),t.plot.shadow&&"s"!=c&&0===s)if(t.ctx.fillStyle="rgba(45,45,45,0.3)",v>0){var H=h<O?O:O+(h-O),z=h<O?M:M-(h-O);NomanicGraph.drawRect(t,s,(x?H:w)+u,NomanicGraph.frm(x?w:H,f,t.plot.scalary,m),x?z:.3*j,x?.3*j:z*t.plot.scalary)}else{var W=NomanicObject.converth(v+N,x?0:f,x?b:0,t.absmin,t.absmax),I=NomanicObject.converth(N,x?0:f,x?b:0,t.absmin,t.absmax);z=p>W?W:p;NomanicGraph.drawRect(t,s,(x?I:w)+u,NomanicGraph.frm(x?w:I,f,t.plot.scalary,m),x?z-I:.3*j,x?.3*j:(z-I)*t.plot.scalary)}t.ctx.restore(),v>0?y+=v:N+=v,t.plot.stacked||(c=[NomanicObject.converth(N,x?0:f,x?b:0,t.absmin,t.absmax),NomanicObject.converth(y,x?0:f,x?b:0,t.absmin,t.absmax)])}c=[NomanicObject.converth(N,x?0:f,x?b:0,t.absmin,t.absmax),NomanicObject.converth(y,x?0:f,x?b:0,t.absmin,t.absmax)],n.push(N+y),i.push((N+y)/2)}if(t.plot.lines){for(o=0;o<t.plot.lines.length;o++)t.plot.lines[o].average&&(t.plot.lines[o].series=i),t.plot.lines[o].sum&&(t.plot.lines[o].series=n);t=NomanicGraph.NMCdrawLine(t,t.plot.lines)}return t.plot.marker&&NomanicGraph.drawmarker(t),t},Gaussian:function(t,e){this.mean=t,this.std=e,this.a=1/Math.sqrt(2*Math.PI)},sGauss:function(){NomanicGraph.Gaussian.prototype={addStd:function(t){this.std+=t},get:function(t){var e=this.a/this.std,a=-.5,o=(t-this.mean)/this.std;return a*=o*o,e*Math.pow(Math.E,a)},generateValues:function(t,e){for(var a=[],o=(Math.abs(t)+Math.abs(e))/100,l=t;l<e;l+=o)a.push(this.get(l));return a},draw:function(t,e,a,o,l){var s=e+o/2-3*o,c=6*o,r=this.generateValues(-10,10),i=r.length;t.ctx.strokeStyle="#454545",t.ctx.beginPath();var n=r[0]/.4;t.ctx.moveTo(s,a+(l-l*n)),r.forEach(function(e,o){0!==o&&(e/=.4,t.ctx.lineTo(s+c*o/i,a+(l-l*e)),n=e)}),t.ctx.lineTo(s,a+(l-l*n)),t.plot.outline&&t.ctx.stroke(),t.ctx.fill()}}},getCurvePoints:function(t,e,a,o){e=void 0!==e?e:.5,a=a||!1,o=o||32;var l,s,c,r,i,n,p,h,d,g,b,f=[],m=[];for(f=t.slice(0),a?(f.unshift(t[t.length-1]),f.unshift(t[t.length-2]),f.unshift(t[t.length-1]),f.unshift(t[t.length-2]),f.push(t[0]),f.push(t[1])):(f.unshift(t[1]),f.unshift(t[0]),f.push(t[t.length-2]),f.push(t[t.length-1])),b=2;b<f.length-4;b+=2)for(g=0;g<=o;g++)l=(f[b+2]-f[b-2])*e,s=(f[b+4]-f[b])*e,c=(f[b+3]-f[b-1])*e,r=(f[b+5]-f[b+1])*e,d=g/o,i=2*Math.pow(d,3)-3*Math.pow(d,2)+1,n=-2*Math.pow(d,3)+3*Math.pow(d,2),p=Math.pow(d,3)-2*Math.pow(d,2)+d,h=Math.pow(d,3)-Math.pow(d,2),m.push(i*f[b]+n*f[b+2]+p*l+h*s),m.push(i*f[b+1]+n*f[b+3]+p*c+h*r);return m},getdash:function(t,e,a,o,l){var s,c;for(s=0;s<32;s++)l.push(t+(c=s/32)*(a-t)),l.push(e+c*(o-e));return l},NMCdrawLines:function(t,e,a){return(t=NomanicGraph.NMCdrawLine(t,!1,a)).plot.lines&&(t=NomanicGraph.NMCdrawLine(t,t.plot.lines,a)),t.plot.marker&&NomanicGraph.drawmarker(t),t},frm:function(t,e,a,o,l){return t/e*(e*a)-o},plotgrid:function(t){var e,a=t.objects.panel.offsetHeight,o=t.objects.panel.offsetWidth,l=t.layout.vertical;if(t.layout.showgrid){t.ctx.strokeStyle=t.layout.chart.gridcolor,t.layout.chart.griddashed?t.ctx.setLineDash([5,3]):t.ctx.setLineDash([]),t.ctx.beginPath();for(var s,c=Math.floor(t.absmin/t.tick)*t.tick,r=0;c<t.absmax;)e=NomanicObject.converth(c,l?0:a,l?o:0,t.absmin,t.absmax),l?(t.ctx.moveTo(e,0),t.ctx.lineTo(e,a)):(t.ctx.moveTo(0,e),t.ctx.lineTo(o,e)),c+=t.tick/t.layout.chart.gridtick;if(t.ctx.stroke(),t.ctx.closePath(),t.ctx.setLineDash([]),t.layout.chart.gridfill){for(t.ctx.beginPath(),c=Math.floor(t.absmin/t.tick)*t.tick,t.ctx.fillStyle=t.layout.chart.gridfill;c<t.absmax;)e=NomanicObject.converth(c,l?0:a,l?o:0,t.absmin,t.absmax),s=NomanicObject.converth(c+t.tick/t.layout.chart.gridtick,l?0:a,l?o:0,t.absmin,t.absmax),l&&r%2==0?t.ctx.fillRect(s,0,e-s,a):r%2==0&&t.ctx.fillRect(0,s,o,e-s),c+=t.tick/t.layout.chart.gridtick,r++;t.ctx.stroke(),t.ctx.closePath()}if(t.plot.grid){for(t.ctx.beginPath(),c=0,t.ctx.strokeStyle=t.layout.chart.gridcolor,t.layout.chart.griddashed?t.ctx.setLineDash([5,3]):t.ctx.setLineDash([]);c<(l?a:o);)l?(t.ctx.moveTo(0,c),t.ctx.lineTo(o,c)):(t.ctx.moveTo(c,0),t.ctx.lineTo(c,a)),c+=(0===t.wbw?1:t.wbw)*t.plot.grid;t.ctx.stroke(),t.ctx.closePath()}}},NMCdrawLine:function(t,e,a){t.wbw=t.bw;var o,l=0;e?(l=1,o=t.plot.data.length):(t.ctx.clearRect(0,0,t.objects.panel.offsetWidth,t.objects.panel.offsetHeight),!a&&t.layout.border&&(t.ctx.beginPath(),t.ctx.linewidth=1,t.ctx.strokeStyle=t.layout.chart.gridcolor,t.ctx.rect(0,0,t.objects.panel.offsetWidth-1,t.objects.panel.offsetHeight-1),t.ctx.stroke(),t.ctx.closePath()),NomanicGraph.doscale(t,1),NomanicGraph.doborder(t),t.legend.heights=[],o=0,NomanicGraph.plotgrid(t));var s,c,r,i,n,p,h,d,g,b,f,m,u,x,y=t.objects.graph.offsetHeight,N=t.objects.graph.offsetWidth,j=-Math.abs((1-t.plot.scalary)*y)/2,w=Math.abs((1-t.plot.scalarx)*N)/2,v=t.layout.vertical,k=e||t.plot.data,O=Math.floor(15/766*t.objects.graph.offsetHeight),M=Math.floor(O/2);for(t.gw=t.gw?t.gw:-1,t.gh=t.gh?t.gh:-1,y==t.gh&&N==t.gw||(t.hintfill=t.ctx.createLinearGradient(0,0,N,y),t.hintfill.addColorStop(0,"rgba(0,0,0,0)"),t.hintfill.addColorStop(1,"rgba(0,0,0,0.4)")),t.wbw=(t.layout.vertical?y*t.plot.scalary:N*t.plot.scalarx)/t.barspp,t.ctx.save(),t.ctx.lineWidth=1,m=0;m<k.length;m++){if(1==t.legend.inuse[t.cs][o+m]&&k[m].fill){if(u=[],g=((s=k[m].series.length)-1)*t.wbw+(l?t.wbw/2:0),e)u.push(g),b=NomanicObject.converth(0,v?0:y,v?N:0,t.absmin,t.absmax),u.push(b),u.push(l?t.wbw/2:0),u.push(b);else for(f=s-1;f>-1;f--){if(u.push(Math.round(g)),h=0,m>0&&t.plot.stacked&&!e)for(d=0;d<m;d++)h+=1==t.legend.inuse[t.cs][d]?k[d].series[f]:0;b=NomanicObject.converth(t.plot.stacked&&!e?h:0,v?0:y,v?N:0,t.absmin,t.absmax),u.push(b),g-=l?t.wbw/2:t.wbw}for(P=k[m].spline?NomanicGraph.getCurvePoints(u):u,u=[],g=l?t.wbw/2:0,f=0;f<k[m].series.length;f++){if(u.push(Math.round(g)),h=0,m>0&&t.plot.stacked&&!e)for(d=0;d<m;d++)h+=1==t.legend.inuse[t.cs][d]?k[d].series[f]:0;b=NomanicObject.converth(k[m].series[f]+h,v?0:y,v?N:0,t.absmin,t.absmax),u.push(b),g+=t.wbw+(N-g<t.wbw/2&&l?N%(t.wbw/2):0)}for(x=k[m].spline?NomanicGraph.getCurvePoints(u):u,t.ctx.save(),t.ctx.beginPath(),t.ctx.moveTo(n=(v?P[1]:P[0])+w,p=NomanicGraph.frm(v?P[0]:P[1],y,t.plot.scalary,j)),f=0;f<P.length;f+=2)t.ctx.lineTo((v?P[f+1]:P[f])+w,NomanicGraph.frm(v?P[f]:P[f+1],y,t.plot.scalary,j));for(t.ctx.lineTo((v?x[1]:x[0])+w,NomanicGraph.frm(v?x[0]:x[1],y,t.plot.scalary,j)),f=0;f<x.length;f+=2)t.ctx.lineTo((v?x[f+1]:x[f])+w,NomanicGraph.frm(v?x[f]:x[f+1],y,t.plot.scalary,j));if(t.ctx.lineTo(n,p),t.pattern[m])T=t.ctx.createPattern(t.pattern[m],"repeat");else if(t.plot.opacityspread&&t.plot.color&&0===o){var G=.8/k.length;T="rgba("+(i=NomanicObject.hexToRgb(t.plot.color))[0]+","+i[1]+","+i[2]+","+(k[m].alpha?k[m].alpha*r:r)+")"}else T=t.legend.ncolors[t.cs][o+m];if(T=k[m].fill?1==k[m].fill?T:k[m].fill:T,1!=(r=k[m].alpha?k[m].alpha:1)&&(t.ctx.globalAlpha=r),t.ctx.fillStyle=T,t.ctx.fill(),t.ctx.closePath(),1!=r&&(t.ctx.globalAlpha=1),t.plot.hint){for(t.ctx.beginPath(),t.ctx.moveTo(n=(v?P[1]:P[0])+w,p=NomanicGraph.frm(v?P[0]:P[1],y,t.plot.scalary,j)),f=0;f<P.length;f+=2)t.ctx.lineTo((v?P[f+1]:P[f])+w,NomanicGraph.frm(v?P[f]:P[f+1],y,t.plot.scalary,j));for(t.ctx.lineTo((v?x[1]:x[0])+w,NomanicGraph.frm(v?x[0]:x[1],y,t.plot.scalary,j)),f=0;f<x.length;f+=2)t.ctx.lineTo((v?x[f+1]:x[f])+w,NomanicGraph.frm(v?x[f]:x[f+1],y,t.plot.scalary,j));t.ctx.lineTo(n,p),t.ctx.fillStyle=t.hintfill,t.ctx.fill(),t.ctx.closePath()}t.ctx.restore(),t.ctx.save()}if(1==t.legend.inuse[t.cs][o+m]){for(u=[],t.ctx.restore(),t.ctx.save(),g=0,t.legend.heights[o+m]=[],f=0;f<k[m].series.length;f++){if(u.push(g),h=0,m>0&&t.plot.stacked&&!e)for(d=0;d<m;d++)h+=1==t.legend.inuse[t.cs][d]?k[d].series[f]:0;b=NomanicObject.converth(k[m].series[f]+h,v?0:y,v?N:0,t.absmin,t.absmax),t.legend.heights[o+m].push([g,b,g>.5*N?1:0]),u.push(b),g+=t.wbw+(N-g<t.wbw?N%t.wbw:0)}if(t.ctx.lineWidth=O/2,t.plot.shadow&&(t.ctx.shadowOffsetX=M,t.ctx.shadowOffsetY=M,t.ctx.shadowBlur=M+M,t.ctx.shadowColor="black"),x=k[m].spline?NomanicGraph.getCurvePoints(u):u,t.ctx.save(),k[m].dashed?t.ctx.setLineDash([15,15]):t.ctx.setLineDash([]),k[m].line)T=k[m].line;else if(t.pattern[m])T=t.ctx.createPattern(t.pattern[m],"repeat");else if(t.plot.opacityspread&&t.plot.color&&0===o){G=.8/k.length;T="rgba("+(i=NomanicObject.hexToRgb(t.plot.color))[0]+","+i[1]+","+i[2]+","+(k[m].alpha?k[m].alpha*r:r)+")"}else T=t.legend.ncolors[t.cs][o+m];if(k[m].neon){if(t.plot.opacityspread&&t.plot.color&&0===o){G=.8/k.length;c=NomanicObject.hexToRgb(t.plot.color),r=.2*(1-G*m)}else c=NomanicObject.hexToRgb(t.legend.ncolors[t.cs][o+m]),r=.2;if(t.ctx.lineCap="round",k[m].cap){x=NomanicGraph.avoid(x,u,Math.floor(5/766*y*2),k[m].spline);var P=[];for(d=0;d<x.length;d++)for(P[d]=[],P[d].push([(v?x[d][1]:x[d][0])+(l?t.wbw/2:0),v?x[d][0]:x[d][1]]),f=2;f<x[d].length;f+=2)g=(v?x[d][f+1]:x[d][f])+(l?t.wbw/2:0),b=v?x[d][f]:x[d][f+1],P[d].push([g,b]);for(d=5;d>=0;d--){var T=0===d?"#fff":"rgba("+c[0]+","+c[1]+","+c[2]+",0.2)";for(t.ctx.strokeStyle=T,f=0;f<P.length;f++){for(t.ctx.beginPath(),t.ctx.lineWidth=3*(d+1)-2,t.ctx.moveTo(P[f][0][0]+w,NomanicGraph.frm(P[f][0][1],y,t.plot.scalary,j)),g=1;g<P[f].length;g++)(C=P[f][g][0])&&(S=P[f][g][1])&&t.ctx.lineTo(C+w,NomanicGraph.frm(S,y,t.plot.scalary,j));t.ctx.stroke(),t.ctx.closePath()}NomanicGraph.drawcaps(t,0,l?t.wbw/2:0,k[m].cap,u,o+m,3*(d+1)-2,T),k[m].cap>3&&NomanicGraph.drawcaps(t,0,l?t.wbw/2:0,k[m].cap+2,u,o+m,3*(d+1)-2,T)}}else for(d=5;d>=0;d--){for(t.ctx.strokeStyle=0===d?"#fff":"rgba("+c[0]+","+c[1]+","+c[2]+",0.2)",t.ctx.beginPath(),t.ctx.lineWidth=3*(d+1)-2,t.ctx.moveTo((v?x[1]:x[0])+(l?t.bw/2:0)+w,NomanicGraph.frm(v?x[0]:x[1],y,t.plot.scalary,j)),f=2;f<x.length;f+=2)(g=(v?x[f+1]:x[f])+(l?t.bw/2:0))&&(b=v?x[f]:x[f+1])&&t.ctx.lineTo(g+w,NomanicGraph.frm(b,y,t.plot.scalary,j));t.ctx.stroke(),t.ctx.closePath()}}else if(t.ctx.strokeStyle=T,k[m].cap){x=NomanicGraph.avoid(x,u,Math.floor(5/766*t.objects.canvas.offsetHeight*2),k[m].spline);var C,S;P=[];for(d=0;d<x.length;d++)for(P[d]=[],P[d].push([(v?x[d][1]:x[d][0])+(l?t.wbw/2:0),v?x[d][0]:x[d][1]]),f=2;f<x[d].length;f+=2)g=(v?x[d][f+1]:x[d][f])+(l?t.wbw/2:0),b=v?x[d][f]:x[d][f+1],P[d].push([g,b]);for(f=0;f<P.length;f++){if(k[m].outline){for(t.ctx.beginPath(),t.ctx.lineWidth=O/2+2,t.ctx.strokeStyle=k[m].fill?1==k[m].fill?"#A0A0A0":k[m].fill:"#A0A0A0",t.ctx.moveTo(P[f][0][0]+w,NomanicGraph.frm(P[f][0][1],y,t.plot.scalary,j)),g=1;g<P[f].length;g++)(C=P[f][g][0])&&(S=P[f][g][1])&&(f!=P.length-1||l||(v?S=t.objects.panel.offsetHeight:C=t.objects.panel.offsetWidth),t.ctx.lineTo(C+w,NomanicGraph.frm(S,y,t.plot.scalary,j)));t.ctx.stroke(),t.ctx.closePath()}for(t.ctx.beginPath(),t.ctx.lineWidth=O/2,t.ctx.strokeStyle=T,t.ctx.moveTo(P[f][0][0]+w,NomanicGraph.frm(P[f][0][1],y,t.plot.scalary,j)),g=1;g<P[f].length;g++)(C=P[f][g][0])&&(S=P[f][g][1])&&(f!=P.length-1||l||(v?S=t.objects.panel.offsetHeight:C=t.objects.panel.offsetWidth),t.ctx.lineTo(C+w,NomanicGraph.frm(S,y,t.plot.scalary,j)));t.ctx.stroke(),t.ctx.closePath()}NomanicGraph.drawcaps(t,0,l,k[m].cap,u,o+m),k[m].cap>3&&NomanicGraph.drawcaps(t,0,l,k[m].cap+2,u,o+m)}else{if(k[m].outline){for(t.ctx.beginPath(),t.ctx.lineWidth=O/2+2,t.ctx.strokeStyle=k[m].fill?1==k[m].fill?"#A0A0A0":k[m].fill:"#A0A0A0",t.ctx.moveTo((v?x[1]:x[0])+(l?t.bw/2:0)+w,NomanicGraph.frm(v?x[0]:x[1],y,t.plot.scalary,j)),f=2;f<x.length;f+=2)(g=(v?x[f+1]:x[f])+(l?t.bw/2:0))&&(b=v?x[f]:x[f+1])&&(f!=x.length-2||l||(v?b=t.objects.panel.offsetHeight:g=t.objects.panel.offsetWidth),t.ctx.lineTo(g+w,NomanicGraph.frm(b,y,t.plot.scalary,j)));t.ctx.stroke(),t.ctx.closePath()}for(t.ctx.beginPath(),t.ctx.lineWidth=O/2,t.ctx.strokeStyle=T,t.ctx.moveTo((v?x[1]:x[0])+(l?t.bw/2:0)+w,NomanicGraph.frm(v?x[0]:x[1],y,t.plot.scalary,j)),f=2;f<x.length;f+=2)(g=(v?x[f+1]:x[f])+(l?t.bw/2:0))&&(b=v?x[f]:x[f+1])&&(f!=x.length-2||l||(v?b=t.objects.panel.offsetHeight:g=t.objects.panel.offsetWidth),t.ctx.lineTo(g+w,NomanicGraph.frm(b,y,t.plot.scalary,j)));t.ctx.stroke(),t.ctx.closePath()}t.ctx.restore(),t.ctx.save(),t.layout.showlegend&&NomanicGraph.drawlegend(t,t.objects.legend.children[0].children[o+m].children[1],k[m].neon?1:0,k[m].dashed?1:0,k[m].cap?1:0,t.legend.ncolors[t.cs][o+m]),t.ctx.restore()}}return t.ctx.save(),t},doscale:function(t,e){t=NomanicObject.objs[t.id];var a,o=Math.floor(t.objects.grapha.offsetWidth),l=Math.floor(t.objects.grapha.offsetHeight),s=t.plot.scalex*(t.czoom/100),c=t.plot.scaley*(t.czoom/100);if(t.oczoom=t.oczoom?t.oczoom:-1,t.czoom!=t.oczoom&&((a=t.objects.graph.style).height=Math.floor(l*c)+"px",a.width=Math.floor(o*s)+"px",100==t.czoom?(a.top=Math.floor(l*(1-c)/2)+"px",a.left=Math.floor(o*(1-s)/2)+"px"):(a.top="0px",a.left="0px")),t.layout.floatingtags){var r,i,n,p=.114*o*(s<c?s:c),h=p,d=.2*p;for(r=0;r<t.objects.tools.children.length;r++)(n=(i=t.objects.tools.children[r]).style).width=h+"px",n.height=p+"px",n.lineHeight=p+"px",n.fontSize=d+"px",i.children[0].innerHTML=NomanicObject.getsvg(NomanicObject.tag,p,"#454545","#F8F8F8")}e&&NomanicGraph.rcnv(t,1)},doborder:function(t){var e=t.objects.graph.offsetHeight,a=t.objects.graph.offsetWidth,o=(t.objects.grapha.offsetHeight-e)/2,l=(t.objects.grapha.offsetWidth-a)/2,s=t.layout.vertical,c=s?t.objects.axisx:t.objects.axisy,r=NomanicGraph.frm(0,e,t.plot.scaley,o);s?(c.style.top=r+e+5+"px",c.style.left=l-c.offsetWidth-5+"px",c.style.width=a+"px"):(c.style.top=t.objects.graph.offsetTop+t.objects.grapha.offsetTop+"px",c.style.left=l+"px",c.style.height=t.objects.graph.offsetHeight+"px")},Vector:function(t,e){this.x=t||0,this.y=e||0,this.add=function(t){return new NomanicGraph.Vector(this.x+t.x,this.y+t.y)},this.subtract=function(t){return new NomanicGraph.Vector(this.x-t.x,this.y-t.y)},this.multiply=function(t){return new NomanicGraph.Vector(this.x*t.x,this.y*t.y)},this.multiplyScalar=function(t){return new NomanicGraph.Vector(this.x*t,this.y*t)},this.divide=function(t){return new NomanicGraph.Vector(this.x/t.x,this.y/t.y)},this.divideScalar=function(t){return new NomanicGraph.Vector(this.x/t,this.y/t)},this.length=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},this.normalize=function(){return this.divideScalar(this.length())}},get_points:function(t,e,a){var o=a.subtract(t);return 0===o.length()?new NomanicGraph.Vector(NaN,NaN):(o=o.normalize(),t.add(o.multiplyScalar(e)))},dist:function(t,e,a){var o=e.subtract(t).length();return Math.abs(o)>a?1:0},avoid:function(t,e,a,o){var l,s,c,r,i=0,n=[],p=0,h=0;if(isNaN(e[1]))return[e];if(o)for(l=0,r=0,n[p=0]=[],h=0;h<t.length;h+=2)1==(s=NomanicGraph.dist(new NomanicGraph.Vector(e[r],e[r+1]),new NomanicGraph.Vector(t[h],t[h+1]),2*a))?(l!=s?(c=NomanicGraph.get_points(new NomanicGraph.Vector(e[r],e[r+1]),2*a,new NomanicGraph.Vector(t[h],t[h+1])),n[p].push(c.x),n[p].push(c.y),r+=2):(n[p].push(t[h]),n[p].push(t[h+1])),i=1):1==i&&l!=s&&(c=NomanicGraph.get_points(new NomanicGraph.Vector(e[r],e[r+1]),2*a,new NomanicGraph.Vector(t[h],t[h+1])),n[p].push(c.x),n[p].push(c.y),n[++p]=[]),l=s;else for(r=0;r<e.length-2;r+=2)n[p]=[],c=NomanicGraph.get_points(new NomanicGraph.Vector(e[r],e[r+1]),2*a,new NomanicGraph.Vector(e[r+2],e[r+3])),n[p].push(c.x),n[p].push(c.y),c=NomanicGraph.get_points(new NomanicGraph.Vector(e[r+2],e[r+3]),2*a,new NomanicGraph.Vector(e[r],e[r+1])),n[p].push(c.x),n[p].push(c.y),p++;return n},addClicks:function(t){return t=NomanicObject.addClick(t,t.objects.panel,function(t,e){var a=NomanicObject.objs[e.id],o=a.objects.canvas.getBoundingClientRect(),l=a.layout.vertical?t.pageY-o.top-window.pageYOffset:t.pageX-o.left-window.pageXOffset;switch(a.layout.type){case"line":a.selx=Math.abs(Math.round((l+a.wbw)/a.wbw)-1),(a.plot.marker||a.plot.highlight)&&(a=a.redraw(a)),(a=a.showdata(a)).onselect?a.onselect(a,a.selx):0,NomanicObject.objs[a.id]=a;break;case"bar":a.selx=Math.abs(Math.floor(l/a.wbw)),(a.plot.marker||a.plot.highlight)&&(a=a.redraw(a)),(a=a.showdata(a)).onselect?a.onselect(a,a.selx):0,NomanicObject.objs[a.id]=a}})},setSelect:function(t,e){return t.selx=e,(t.plot.marker||t.plot.highlight)&&(t=t.redraw(t)),t=t.showdata(t),NomanicObject.objs[t.id]=t,t},addClicksPolar:function(t){return t=NomanicObject.addClick(t,t.objects.panel,function(t,e){var a,o=NomanicObject.objs[e.id],l={},s={},c=o.objects.graph;for(a=c.offsetParent,l.x=t.touches?t.touches[0].pageX:t.pageX,l.y=t.touches?t.touches[0].pageY:t.pageY,s.left=c.offsetLeft,s.top=c.offsetTop;a;)s.left+=a.offsetLeft,s.top+=a.offsetTop,a=a.offsetParent;var r=l.y-s.top,i=l.x-s.left,n=360*Math.abs(2*Math.atan2(r-(o.cy-Math.sqrt(Math.abs(i-o.cx)*Math.abs(i-o.cx)+Math.abs(r-o.cy)*Math.abs(r-o.cy))),i-o.cx)/NomanicObject.Pi2);n=(n<0?n+360:n)%360,o.selx=Math.floor(n/(360/(o.plot.data[0]?o.plot.data[0].series.length:o.plot.lines[0].series.length))),(o.plot.marker||o.plot.highlight)&&(o=o.redraw(o));(o=o.showdata(o)).onselect&&o.onselect(o,o.selx);NomanicObject.objs[o.id]=o})},updateaxis:function(t,e){var a,o,l,s=t.objects.graph.offsetHeight*t.plot.scalary,c=t.objects.graph.offsetWidth*t.plot.scalarx,r=(t.objects.graph.offsetHeight,t.objects.graph.offsetWidth,0),i=0,n=t.plot.data,p=0,h=0,d=n[0].series.length-("line"==t.layout.type?1:0),g=t.plot.fit?t.plot.fit:d,b=-1==g?d:g,f=(t.layout.vertical?s:c)/b;t.layout.vertical;for(t.barspp=b,l=0;l<d;l++){for(p=0,h=0,o=0;o<n.length;o++)a=n[o].series[l],t.plot.stacked?a>0?p+=a:h+=a:(h=a<h?a:h,p=a>p?a:p);r=r<h?r:h,i=i>p?i:p}r=0===r?0:r,i=0===i?0:i,(t.plot.min||0===t.plot.min)&&(r=t.plot.min,i=t.plot.max);for(var m,u,x,y,N=[1,2,5,10,25,50,100,200,250,500,1e3,2e3,2500,5e3,1e4,2e4,25e3,5e4,1e5,2e5,25e4,5e5,1e6,2e6,25e6,5e7],j=s||400,w=j/(i-r),v=parseInt(j/w),k=0;v>8;)v=parseInt(j/(w*N[k])),k++;x=N[k];var O=(m=-((m=parseInt(Math.abs(r)/x))*x-r>0?m+1:m))*x*1.1,M=(u=(u=parseInt(i/x))*x-i<0?u+1:u)*x*1.1,G=O%x,P=M%x;G=0!=G?parseInt(r/x)*x-x:O;var T,C=P=0!=P?parseInt(i/x)*x+x:M,S=G,H=(P-G)/x,z="",W=t.layout.vertical,I=W?t.objects.axisx:t.objects.axisy,A=1.1*P,F=1.1*G;if(F=t.plot.yorigin?0:F,S=t.plot.yorigin?0:S,(t.plot.min||0===t.plot.min)&&(F=t.plot.min,A=t.plot.max,S=0!=F?parseInt(F/x)*x-x:F,C=0!=A?parseInt(A/x)*x+x:A),t.absmin<=F&&t.absmax>=A&&!e)return NomanicGraph.rcnv(t),t;for(T=W?S:C,o=0;o<H+1;o++)(y=100-(T-F)/(A-F)*100)<=100&&y>=0&&(z+='<span class="blk '+(W?"xval h100 tc":"yval w100 tr")+'" style="'+(W?"":"transform: translateY(-50%);")+(W?"left:":"top:")+(W?100-y:y)+'%;">'+NomanicObject.abbrNum(T)+"&nbsp;</span>"),T+=W?x:-x;return I.innerHTML=z,t.canvasratio=f*d/(W?c:s),t.bw=f,t.wbw=t.bw,t.rt0=t.bw/(W?c:s),t.maxl=d,t.absmin=F,t.absmax=A,t.tick=x,NomanicGraph.rcnv(t),t},rcnv:function(t,e){var a,o=t.objects.canvas.style,l=t.objects.panel,s=t.objects.graph.offsetWidth,c=t.objects.graph.offsetHeight;t.wbw=(t.layout.vertical?c*t.plot.scalary:s*t.plot.scalarx)/t.barspp,t.fixg?(t.height=c,t.width=s,o.width=t.width+"px",o.height=t.height+"px",l.setAttribute("height",c),l.setAttribute("width",s)):t.layout.vertical?(a=(a=t.wbw*t.maxl)>c?a:c,o.height=a+"px",o.width=s+"px",l.setAttribute("height",a),l.setAttribute("width",s)):(a=(a=t.wbw*t.maxl)>s?a:s,o.width=a+"px",o.height=c+"px",l.setAttribute("width",a),l.setAttribute("height",c)),e||NomanicGraph.doscale(t)},updateaxisPolar:function(t,e){var a,o,l=0,s=t.plot.data,c=0,r=s[0]?s[0].series.length:t.plot.lines[0].series.length,i=r,n=360/i;if(t.barspp=i,t.plot.data.length>0)for(o=0;o<r;o++){for(c=0,a=0;a<s.length;a++)c+=s[a].series[o];l=l>c?l:c}if(t.plot.lines)for(a=0;a<t.plot.lines.length;a++)if(t.plot.lines[a].series)for(o=0;o<t.plot.lines[a].series.length;o++)l=l>(c=t.plot.lines[a].series[o])?l:c;for(var p,h=[1,2,5,10,25,50,100,200,250,500,1e3,2e3,2500,5e3,1e4,2e4,25e3,5e4,1e5,2e5,25e4,5e5,1e6,2e6,25e6,5e7],d=0,g=(l=0===l?.2:l)/h[d],b=h[d];g>5;)g=l/(b=h[d++]);var f=(p=(p=parseInt(l/b))*b-l<0?p+1:p)*b,m=f%b,u=(m=0!=m?parseInt(l/b)*b+b:f,m);return t.absmax>=u&&!e?(NomanicGraph.rcnv(t),t):(t.canvasratio=n*r/t.objects.graph.offsetHeight,t.wbw=n,t.maxl=r,t.absmax=u,t.tick=b,NomanicGraph.rcnv(t),t)},update:function(t,e,a){if((t=NomanicObject.objs[t.id])&&!t.introrunning){var o,l=Math.min(e.length,t.plot.data.length);for(o=0;o<l;o++)for(t.plot.data[o].series.push(e[o]);t.plot.fixed<t.plot.data[o].series.length;)t.plot.data[o].series.shift(),0===o&&(t.time=moment.unix(t.plot.timestart),t.time.add(t.plot.timestep,t.plot.timeunit),t.plot.timestart=t.time.unix());if(a&&t.plot.lines)for(l=Math.min(a.length,t.plot.lines.length),o=0;o<l;o++)for(t.plot.lines[o].series.push(a[o]);t.plot.fixed<t.plot.lines[o].series.length;)t.plot.lines[o].series.shift();var s,c,r=t.plot.data,i=0;for(s=r[0].series.length-1;s>-1;s--){for(i=0,c=0;c<r.length;c++)t.plot.data[c].totals=t.plot.data[c].totals?t.plot.data[c].totals:[],i+=Math.abs(t.plot.data[c].series[s]);for(c=0;c<r.length;c++)t.plot.data[c].totals[s]=t.plot.stacked?i:Math.abs(t.plot.data[c].series[s])}(t=(t=t.updateaxis(t)).redraw(t)).showdata(t);t.onupdate&&t.onupdate(t);NomanicObject.objs[t.id]=t}},replaced:function(t,e,a,o,l){if(l=l&&l>500?l:750,(t=NomanicObject.objs[t.id])&&!t.introrunning){t.tween2=t.tween2?t.tween2:new NomanicObject.tweenable,t.run2&&t.tween2.stop(),t.run2=1;var s=JSON.parse(JSON.stringify(t.plot)),c=JSON.parse(JSON.stringify(t.plot));if(2==o){var r={};r.ar=[t,s,e,Math.min(e.length,t.plot.data.length),c,a,o],NomanicObject.fader(1,0,t.objects.grunge.children[0],l-500,function(){var e,a,o=r.ar,l=o[3];for(a=0;a<l;a++)for(e=0;e<o[0].plot.data[a].series.length;e++)o[0].plot.data[a].series[e]=o[2][a][e];if(o[4]&&o[5])for(l=Math.min(o[4].lines.length,o[5].length),a=0;a<l;a++)for(e=0;e<t.plot.lines[a].series.length;e++)o[0].plot.lines[a].series[e]=o[5][a][e];var s,c,i=o[0].plot.data,n=0,p=i[0]?i[0].series.length:0;if(!o[0].pie)for(s=p-1;s>-1;s--){for(n=0,c=0;c<i.length;c++)o[0].plot.data[c].totals=o[0].plot.data[c].totals?o[0].plot.data[c].totals:[],n+=Math.abs(o[0].plot.data[c].series[s]);for(c=0;c<i.length;c++)o[0].plot.data[c].totals[s]=o[0].plot.stacked?n:Math.abs(o[0].plot.data[c].series[s])}o[0].updateaxis(o[0]),o[0]=o[0].redraw(o[0]),o[0].showdata(o[0]),NomanicObject.objs[o[0].id]=o[0],NomanicObject.fader(0,500,o[0].objects.grunge.children[0],500)})}else t.tween2.create({duration:l||(o?3==o?1500:2==o?1e3:t.pie?1e3:1500:1500),easing:NomanicObject.easer.easeInOutQuad,target:[t,s,e,Math.min(e.length,t.plot.data.length),c,a,o,t.plot.scalarx,t.plot.scalary],step:function(t,e){var a,o,l,s,c=t[0],r=t[3];for(3==t[6]&&(o=(90+360*e)/360*NomanicObject.Pi2,l=(Math.sin(o)+1)/2,t[0].plot.scalarx=t[7]*l,t[0].plot.scalary=t[8]*l),s=0;s<r;s++)for(a=0;a<t[0].plot.data[s].series.length;a++)3==t[6]?t[0].pie?t[0].plot.data[s].series[a]=e>.5?t[2][s][a]:t[1].data[s].series[a]:t[0].plot.data[s].series[a]=NomanicObject.easer.interp(t[1].data[s].series[a],t[2][s][a],e):t[0].pie?t[0].plot.data[s].series[a]=e<.5?NomanicObject.easer.interp(t[1].data[s].series[a],0,2*e):NomanicObject.easer.interp(0,t[2][s][a],2*e):t[0].plot.data[s].series[a]=NomanicObject.easer.interp(t[1].data[s].series[a],t[2][s][a],e);if(t[4]&&t[5])for(r=Math.min(t[4].lines.length,t[5].length),s=0;s<r;s++)for(a=0;a<t[0].plot.lines[s].series.length;a++)t[0].plot.lines[s].series[a]=NomanicObject.easer.interp(t[4].lines[s].series[a],t[5][s][a],e);if(1==t[6]){var i,n,p=t[0].plot.data,h=0;for(i=(p[0]?p[0].series.length:0)-1;i>-1;i--){for(h=0,n=0;n<p.length;n++)c.plot.data[n].totals=c.plot.data[n].totals?c.plot.data[n].totals:[],h+=Math.abs(c.plot.data[n].series[i]);for(n=0;n<p.length;n++)c.plot.data[n].totals[i]=c.plot.stacked?h:Math.abs(c.plot.data[n].series[i])}}t[0].updateaxis(t[0]),t[0].redraw(t[0],t[0].pie&&1==t[6]?1:0,3==t[6]?1:0),3==t[6]&&2==t[0].mtype&&(t[0].objects.axisx.style.display="none",t[0].objects.axisy.style.display="none",t[0].objects.grid.style.display="none"),t[0].showdata(t[0]),NomanicObject.objs[t[0].id]=t[0];(c=t[0]).onupdate&&c.onupdate(c)},finish:function(t,e){var a,o,l=t[0],s=t[3];for(1,o=0;o<s;o++)for(a=0;a<t[0].plot.data[o].series.length;a++)3==t[6]?t[0].plot.data[o].series[a]=NomanicObject.easer.interp(t[1].data[o].series[a],t[2][o][a],1):t[0].pie?t[0].plot.data[o].series[a]=NomanicObject.easer.interp(0,t[2][o][a],2):t[0].plot.data[o].series[a]=NomanicObject.easer.interp(t[1].data[o].series[a],t[2][o][a],1);if(t[4]&&t[5])for(s=Math.min(t[4].lines.length,t[5].length),o=0;o<s;o++)for(a=0;a<t[0].plot.lines[o].series.length;a++)t[0].plot.lines[o].series[a]=NomanicObject.easer.interp(t[4].lines[o].series[a],t[5][o][a],1);var c,r,i=t[0].plot.data,n=0;for(c=(i[0]?i[0].series.length:0)-1;c>-1;c--){for(n=0,r=0;r<i.length;r++)l.plot.data[r].totals=l.plot.data[r].totals?l.plot.data[r].totals:[],n+=Math.abs(l.plot.data[r].series[c]);for(r=0;r<i.length;r++)l.plot.data[r].totals[c]=l.plot.stacked?n:Math.abs(l.plot.data[r].series[c])}t[0].updateaxis(t[0]),t[0].redraw(t[0]),3==t[6]&&2==t[0].mtype&&(t[0].objects.axisx.style.display="block",t[0].objects.axisy.style.display="block",t[0].objects.grid.style.display="block"),t[0].showdata(t[0]),t[0].run2=0,NomanicObject.objs[t[0].id]=t[0]},autorun:1})}},preintro:function(t){if(t=NomanicObject.objs[t.id]){t.introrunning=1;var e=t.plot.intro;if(2==e)NomanicObject.fader(1,0,t.objects.grunge.children[0],500);else{var a=[t,e];3==a[1]&&(a[0].plot.scalex=0,a[0].plot.scaley=0),3!=a[1]&&a[0].updateaxis(a[0]),a[0].redraw(a[0],!1,1),3==a[1]&&(a[0].objects.axisx.style.display="none",a[0].objects.axisy.style.display="none",a[0].objects.grid.style.display="none")}return t}},intro:function(t){if(t=NomanicObject.objs[t.id]){t.objects.graph.style.color=null,t.tween2=t.tween2?t.tween2:new NomanicObject.tweenable,t.run2&&t.tween2.stop(),t.run2=1;var e=t.plot.intro,a=JSON.parse(JSON.stringify(t.plot));if(2==e){var o=t;t.plot.scalex=t.scalex,t.plot.scaley=t.scaley,o.objects.axisx.style.display=o.layout.showaxis?"block":"none",o.objects.axisy.style.display=o.layout.showaxis?"block":"none",o.objects.grid.style.display=o.layout.showgrid?"block":"none",t.rsr(t),NomanicObject.fader(0,t.idelay?t.idelay:1500,t.objects.grunge.children[0],500,function(){o.introrunning=0,NomanicObject.sortoutslider(o,1),NomanicObject.sortoutzoomslider(o,1),NomanicObject.sortoutzoomslider(o,1,1),NomanicObject.sortouttrayslider(o,1),o.showdata(o)})}else t.tween2.create({duration:t.idelay?t.idelay:1500,easing:NomanicObject.easer.easeInOutQuad,target:[t,e,a,t.scalex,t.scaley],step:function(t,e){var a,o,l,s=t[0];for(3==t[1]&&(t[0].plot.scalex=t[3]*e,t[0].plot.scaley=t[4]*e),o=0;o<l;o++)for(a=0;a<t[0].plot.data[o].series.length;a++)3==t[6]?t[0].pie?t[0].plot.data[o].series[a]=t[2].data[o].series[a]:t[0].plot.data[o].series[a]=NomanicObject.easer.interp(0,t[2].data[o].series[a],e):t[0].pie?t[0].plot.data[o].series[a]=e<.5?NomanicObject.easer.interp(t[2].data[o].series[a],0,2*e):NomanicObject.easer.interp(0,t[2].data[o].series[a],2*e):t[0].plot.data[o].series[a]=NomanicObject.easer.interp(0,t[2].data[o].series[a],e);if(t[0].plot.lines.length>0&&t[2].lines.length>0)for(l=Math.min(t[0].plot.lines.length,t[2].lines.length),o=0;o<l;o++)for(a=0;a<t[2].lines[o].series.length;a++)t[0].plot.lines[o].series[a]=NomanicObject.easer.interp(0,t[2].lines[o].series[a],e);if(1==t[1]||t[0].pie){var c,r,i=t[0].plot.data,n=0;for(c=(i[0]?i[0].series.length:0)-1;c>-1;c--){for(n=0,r=0;r<i.length;r++)t[0].plot.data[r].totals=t[0].plot.data[r].totals?t[0].plot.data[r].totals:[],n+=Math.abs(s.plot.data[r].series[c]);for(r=0;r<i.length;r++)t[0].plot.data[r].totals[c]=t[0].plot.stacked?n:Math.abs(t[0].plot.data[r].series[c])}}t[0].updateaxis(t[0],1),3==t[1]&&(t[0].objects.axisx.style.display="none",t[0].objects.axisy.style.display="none",t[0].objects.grid.style.display="none"),t[0].redraw(t[0],!1,1)},finish:function(e,a){e[0].plot.scalex=e[3],e[0].plot.scaley=e[4],e[0].updateaxis(e[0],1),3==e[1]&&(e[0].objects.axisx.style.display=t.layout.showaxis?"block":"none",e[0].objects.axisy.style.display=t.layout.showaxis?"block":"none",e[0].objects.grid.style.display=t.layout.showgrid?"block":"none"),NomanicObject.sortoutslider(e[0],1),NomanicObject.sortoutzoomslider(e[0],1),NomanicObject.sortoutzoomslider(e[0],1,1),NomanicObject.sortouttrayslider(e[0],1),e[0].showdata(e[0]),e[0].redraw(e[0]),e[0].run2=0,t.introrunning=0,NomanicObject.objs[e[0].id]=e[0]},autorun:1})}},dep:function(){moment().format()},setup:function(){NomanicObject.register("NomanicGraph.create",["line","bar","polar","pie","halfpie"]),NomanicObject.addscript([]),NomanicObject.addtype(NomanicGraph),NomanicGraph.sGauss()},breakdown:function(t,e,a,o){var l,s=NomanicObject.replaceAll(e,"{",""),c=(s=NomanicObject.replaceAll(s,"}","").split("."))[0][0],r=s[0].substring(1),i=(s[1]?s[1]:"").length,n=r.length,p="unknown";switch(c){case"a":p=t.time.format("dddd Do MMMM YYYY");break;case"b":p=t.time.format("Do MMMM YYYY");break;case"c":p=t.time.format("MMMM YYYY");break;case"Y":p=t.time.format("YYYY");break;case"f":return t.ongettag?t.ongettag(a,o,t.time.unix()):"";case"i":p=t.time.format("HH:mm:ss");break;case"g":p=t.time.format("h:mma dddd Do MMMM YYYY");break;case"M":p=t.time.format("MMMM");break;case"W":p=t.time.format("W");break;case"d":p=t.time.format("dddd");break;case"o":p=t.time.format("o");break;case"h":p=t.time.format("H");break;case"t":p=t.time.format("a");break;case"m":p=t.time.format("m");break;case"s":p=t.time.format("s");break;case"p":l=o,p=(0===n?l:NomanicObject.padZero(Math.floor(l),n))+(0===i?"":((l-Math.floor(l)).toFixed(i)+"").substring(1));break;case"u":l=a,p=(0===n?l:NomanicObject.padZero(Math.floor(l),n))+(0===i?"":((l-Math.floor(l)).toFixed(i)+"").substring(1));break;case"k":p=NomanicObject.abbrNum(parseInt(a))}return p},gettag:function(t,e,a,o){return e.replace(/\{[[a-zA-Z]{1}[0-9]{0,6}(?:\.\d+)?\}/gm,function(e,l){return NomanicGraph.breakdown(t,e,a,o)})},showdata:function(t){var e,a,o,l,s,c,r,i,n=[];if(2!=t.layout.subtype){for(t.time=moment.unix(t.plot.timestart),a=0;a<t.objects.legend.children[0].children.length;a++)e=(o=t.objects.legend.children[0].children[a]).children,t.plot.data[a]?(s=0===(s=t.plot.data[a].totals[t.selx])?1:s,c=(1==t.legend.inuse[t.cs][a]?Math.abs(t.plot.data[a].series[t.selx]):0)/s*100,r=t.plot.data[a].series[t.selx],i=-1==t.selx?"":NomanicGraph.gettag(t,t.plot.tagformat,r,c),e[0].innerHTML=i,e[1].style.opacity=-1==t.selx?0:1,NomanicObject.hasClass(e[1],"done")||(e[1].style.background=t.lpattern[a]?"url("+t.lpattern[a]+")":t.legend.ncolors[t.cs][a],NomanicObject.addClass(e[1],"done")),e[2].style.innerHTML=-1==t.selx?"":t.legend.labels[t.cs][a],n[a]=-1!=t.selx&&[t.legend.ncolors[t.cs][a],t.legend.labels[t.cs][a],i],o=t.objects.tools.children[a],t.layout.floatingtags&&(1==t.legend.inuse[t.cs][a]?t.legend.heights[a]&&(l=t.legend.heights[a][t.selx],o.children[1].innerHTML=NomanicObject.abbrNum(t.plot.data[a].series[t.selx]),o.style.left=(t.layout.vertical?l[1]-o.offsetWidth/2:l[0]-o.offsetWidth/2)+"px",o.style.top=(t.layout.vertical?l[0]-o.offsetHeight/2:l[1]-o.offsetHeight/2)+"px"):(o.style.left="-1000px",o.style.top="-1000px"))):(s=1,c=100,0,r=t.plot.lines[a-t.plot.data.length].series[t.selx],i=-1==t.selx?"":NomanicGraph.gettag(t,t.plot.tagformat,r,c),e[0].innerHTML=i,e[1].style.opacity=-1==t.selx?0:1,NomanicObject.hasClass(e[1],"done")||(e[1].style.background=t.lpattern[0+a]?"url("+t.lpattern[0+a]+")":t.legend.ncolors[t.cs][0+a],NomanicObject.addClass(e[1],"done")),e[2].style.innerHTML=-1==t.selx?"":t.legend.labels[t.cs][0+a],n[a]=-1!=t.selx&&[t.legend.ncolors[t.cs][0+a],t.legend.labels[t.cs][0+a],i],o=t.objects.tools.children[0+a],t.layout.floatingtags&&(1==t.legend.inuse[t.cs][0+a]?t.legend.heights[0+a]&&(l=t.legend.heights[0+a][t.selx],o.children[1].innerHTML=NomanicObject.abbrNum(t.plot.lines[a-t.plot.data.length].series[t.selx]),o.style.left=(t.layout.vertical?l[1]-o.offsetWidth/2:l[0]-o.offsetWidth/2)+"px",o.style.top=(t.layout.vertical?l[0]-o.offsetHeight/2:l[1]-o.offsetHeight/2)+"px"):(o.style.left="-1000px",o.style.top="-1000px")));t.selx>0&&t.time.add(t.selx*t.plot.timestep,t.plot.timeunit);var p=t.ongetmenu?t.ongetmenu(t,r,c,t.time.unix()):NomanicGraph.gettag(t,t.plot.menuformat,t.selx,0);t.layout.showmenu&&(p=t.plot.menu?t.plot.menu[t.selx]:p,t.objects.head.children[0].children[1].children[0].innerHTML=p),t.menu=p;t.onshowdata&&t.onshowdata(t,n,p);return t}},redolegend:function(t,e,a,o,l,s){return s.plot.color=t,s.setink(e),s.setcink(a),s.setgink(o),NomanicGraph.buildlegend(s,s.cs,s.plot.data,l,1),s=s.rsr(s)},buildlegend:function(t,e,a,o,l){var s,c,r,i=[],n=[],p=[];for(c=0;c<a.length;c++)a[c].color&&i.push(a[c].color),p.push(a[c].label?a[c].label:"");if(i.length!=a.length||l){if(t.plot.opacityspread){i=[];var h=.8/a.length,d=NomanicObject.hexToRgb(t.plot.color?t.plot.color:NomanicObject.defcolor);for(c=0;c<a.length;c++)i[c]="rgba("+d[0]+","+d[1]+","+d[2]+","+(1-h*c)+")"}else i=NomanicObject.generate(t.plot.color?t.plot.color:NomanicObject.defcolor,a.length);if(l)for(c=0;c<a.length;c++)a[c].color=i[c]}if(t.plot.highlight){if(t.plot.opacityspread){n=[];h=.8/a.length,d=NomanicObject.hexToRgb(t.plot.high?t.plot.high:NomanicObject.defcolor);for(c=0;c<a.length;c++)n[c]="rgba("+d[0]+","+d[1]+","+d[2]+","+(1-h*c)+")"}else n=NomanicObject.generate(t.plot.high?t.plot.high:NomanicObject.defcolor,a.length);for(c=0;c<a.length;c++)a[c].high=n[c]}if(t.plot.lines)for(r=0;r<t.plot.lines.length;r++)p.push(t.plot.lines[r].label?t.plot.lines[r].label:""),i.push(o&&o[r]?o[r]:t.plot.lines[r].color?t.plot.lines[r].color:"");for(t.legend.colors[e]=i,t.legend.labels[e]=p,t.legend.ncolors=[],s=0;s<t.legend.colors.length;s++)for(t.legend.ncolors[s]=[],c=0;c<t.legend.colors[s].length;c++)t.legend.ncolors[s][c]=t.legend.darken?NomanicObject.lighten(t.legend.colors[s][c],t.legend.darken):t.legend.colors[s][c];return t.layout.pencil.nink=t.layout.pencil.darken?NomanicObject.lighten(t.layout.pencil.ink,t.layout.pencil.darken):t.layout.pencil.ink,t.layout.chart.nink=t.layout.chart.darken?NomanicObject.lighten(t.layout.chart.ink,t.layout.chart.darken):t.layout.chart.ink?t.layout.chart.ink:t.layout.pencil.ink,t},loadlegend:function(t){var e,a,o="",l="";if(t.legend.inuse=[],t.legend.inuse[t.cs]=[],2==t.layout.subtype)o+='<div style="float:left;width:100%;"><div style="float:right;width:30%;height:100%;font-weight:bold;text-align:right;overflow:hidden;">'+(50-100*Math.random()).toFixed(2)+'</div><div class="brdr" child="'+e+'" style="opacity:0;float:left;background:'+t.legend.ncolors[t.cs][e]+';"></div><div style="float:left;height:100%;width:50%;overflow:hidden;"></div></div>';else for(e=0;e<t.legend.labels[t.cs].length;e++)t.layout.showlegend<1?o+='<div class="blk w100 h100"><div class="blk" style="font-weight:bold;text-align:right;overflow:hidden;">'+(50-100*Math.random()).toFixed(2)+'</div><div class="blk brdr" child="'+e+'" style="background:'+t.legend.ncolors[t.cs][e]+';"></div><div class="blk">'+t.legend.labels[t.cs][e]+"</div></div>":o+='<div style="float:left;width:'+100/t.legend.columns+'%;"><div style="float:right;width:30%;height:100%;font-weight:bold;text-align:right;overflow:hidden;">'+(50-100*Math.random()).toFixed(2)+'</div><div class="brdr" child="'+e+'" style="float:left;background:'+t.legend.ncolors[t.cs][e]+';"></div><div style="float:left;height:100%;width:35%;overflow:hidden;">'+t.legend.labels[t.cs][e]+"</div></div>",t.layout.floatingtags&&(l+='<div class="blk tc" style="color:#F8F8F8;font-weight:bold;"><div class="blk"></div><div class="blk w100 h100 tc"></div></div>'),t.legend.inuse[t.cs][e]=1;for(t.objects.legend.children[0].innerHTML=o,e=0;e<t.objects.legend.children[0].children.length;e++)a=t.objects.legend.children[0].children[e],t=NomanicObject.addClick(t,a.children[1],function(t,e){NomanicGraph.togglelegend(t,e)});return t.objects.tools.innerHTML=l,t},togglelegend:function(t,e){var a=NomanicObject.objs[e.id],o=parseInt(t.target.getAttribute("child"));NomanicGraph.showlegend(a,o,1-a.legend.inuse[a.cs][o])},showlegend:function(t,e,a){t.legend.inuse[t.cs][e]=a,t.objects.legend.children[0].children[e].style.opacity=1==a?1:.3;(t=(t=t.rsr(t)).showdata(t)).ontogglelegend&&t.ontogglelegend(t,e,a);NomanicObject.objs[t.id]=t},getdata:function(t,e){e=e||t.selx;var a=0,o=[];for(a=0;a<t.plot.data.length;a++)o.push([t.plot.data[a].series[e]]);return o},getmenu:function(t){return t.menu},getlegend:function(t){return{colors:t.legend.ncolors,labels:t.legend.labels,inuse:t.legend.inuse}},parsebase:function(t,e,a){var o,l,s,c,r,i=NomanicObject.splitter(e);for(t.plot.donuty=1,t.plot.seperate=0,t.plot.scalarx=1,t.plot.scalary=1,t.plot.scalex=1,t.plot.scaley=1,c=0;c<i.length;c++)switch((r=i[c].split("|"))[1]=r[1]?r[1]:1,r[0]){case"legend":t.legend.columns=parseInt(r[1]);break;case"datatype":t.datatype=NomanicObject.stripq(r[1]);break;case"showaxis":t.layout.showaxis=1;break;case"intro":r=NomanicObject.stripc(NomanicObject.stripq(r[1])),t.plot.intro=parseInt(r[0]),t.idelay=parseInt(r[1]);break;case"minmax":r=NomanicObject.stripc(NomanicObject.stripq(r[1])),t.plot.min=parseInt(r[0]),t.plot.max=parseInt(r[1]);break;case"showgrid":t.layout.showgrid=1;break;case"showzoom":t.layout.showzoom=1;break;case"showmenu":t.layout.showmenu=1;break;case"menu":t.plot.menu=NomanicObject.gsary(r[1]);break;case"showtitle":t.layout.showtitle=1;break;case"replacedelay":t.rdelay=parseInt(r[1]);break;case"showlegend":var n=parseFloat(r[1]);n=n>1?1:n,t.layout.showlegend=n;break;case"select":t.layout.select=parseInt(r[1]);break;case"floatingtags":t.layout.floatingtags=1;break;case"stacked":t.plot.stacked=1;break;case"marker":t.plot.marker=1;break;case"hint":t.plot.hint=1;break;case"shadow":t.plot.shadow=1;break;case"yorigin":t.plot.yorigin=1;break;case"fullscreen":t.layout.fullscreen=1;break;case"vertical":t.layout.vertical=1;break;case"spark":t.layout.spark=1;break;case"outline":t.plot.outline=1;break;case"notext":t.plot.notext=1;break;case"fit":t.plot.fit=parseInt(r[1]);break;case"fixed":t.plot.fixed=parseInt(r[1]);break;case"grid":t.plot.grid=parseInt(r[1]);break;case"round":r=NomanicObject.stripc(NomanicObject.stripq(r[1])),t.plot.round=parseInt(r[0]),t.plot.roundgap=!!r[1]&&parseFloat(r[1]);break;case"donut":r=NomanicObject.stripc(NomanicObject.stripq(r[1])),t.plot.donut=parseFloat(r[0]),t.plot.donuty=r[1]?parseFloat(r[1]):1;break;case"neon":t.plot.neon=1;break;case"3d":t.plot.egg=1;break;case"3d2":r=NomanicObject.stripc(NomanicObject.stripq(r[1])),t.plot.egg2=parseFloat(r[0]),t.plot.eggshade2=r[1]?parseFloat(r[1]):.2,t.plot.eggcol2=!!r[2]&&NomanicObject.stripq(r[2]);break;case"3d3":r=NomanicObject.stripc(NomanicObject.stripq(r[1])),t.plot.egg3=parseFloat(r[0]),t.plot.eggshade3=r[1]?parseFloat(r[1]):.2,t.plot.eggcol3=!!r[2]&&NomanicObject.stripq(r[2]);break;case"number":r=NomanicObject.stripc(NomanicObject.stripq(r[1])),t.plot.number=[],t.plot.number[0]=parseInt(r[0]),t.plot.number[1]=NomanicObject.stripq(r[1]),t.plot.number[2]=parseFloat(r[2]);break;case"band":for(r=NomanicObject.stripc(NomanicObject.stripq(r[1])),t.plot.band=[0],o=0;o<r.length;o+=2)t.plot.band[o+1]=!!r[o]&&NomanicObject.stripq(r[o]),t.plot.band[o+2]=r[o+1]?parseFloat(r[o+1]):1;break;case"braid":for(r=NomanicObject.stripc(NomanicObject.stripq(r[1])),t.plot.braidgap=[],o=0;o<r.length;o+=4)t.plot.braidgap[o]=parseFloat(r[o]),t.plot.braidgap[o+1]=parseFloat(r[o+1]),t.plot.braidgap[o+2]=parseFloat(r[o+2]),t.plot.braidgap[o+3]=NomanicObject.stripq(r[o+3]);break;case"scalar":r=NomanicObject.stripc(NomanicObject.stripq(r[1])),t.plot.scalex=parseFloat(r[0]),t.plot.scaley=r[1]?parseFloat(r[1]):parseFloat(r[0]);break;case"outerring":t.plot.outerring=1;break;case"innerring":t.plot.innerring=1;break;case"inset":t.plot.inset=1;break;case"gridlines":t.plot.gridlines=parseFloat(r[1]);break;case"color":t.plot.color=r[1];break;case"seperate":r=NomanicObject.stripc(NomanicObject.stripq(r[1])),t.plot.seperate=parseInt(r[0]),t.plot.seperatex=!!r[1]&&parseInt(r[1]);break;case"opacityspread":t.plot.opacityspread=1;break;case"highlight":t.plot.high=r[1],t.plot.highlight=1;break;case"menuformat":t.plot.menuformat=NomanicObject.stripq(r[1]);break;case"timestart":t.plot.timestart=parseInt(r[1]);break;case"timestep":t.plot.timestep=parseInt(r[1]);break;case"timeunit":t.plot.timeunit=NomanicObject.stripq(r[1]);break;case"tagformat":t.plot.tagformat=NomanicObject.stripq(r[1])}if((t=NomanicObject.parsebase(t,e,a)).container.hasAttribute("data"))for(s=NomanicObject.splitter(t.container.getAttribute("data"),"{","}"),c=0;c<s.length;c++)for(t.plot.data[c]={},t.plot.data[c].colors=[],t.plot.data[c].idonut=0,t.plot.data[c].odonut=1,i=NomanicObject.splitter(s[c]),l=0;l<i.length;l++)switch((r=i[l].split("|"))[1]=r[1]?r[1]:1,r[0]){case"series":t.plot.data[c].series=NomanicObject.gary(r[1]);break;case"icon":t.plot.data[c].icon=NomanicObject.stripq(r[1]);break;case"label":t.plot.data[c].label=NomanicObject.stripq(r[1]);break;case"color":t.plot.data[c].color=r[1];break;case"line":t.plot.data[c].line=r[1];break;case"spline":t.plot.data[c].spline=1;break;case"cap":t.plot.data[c].cap=r[1]?parseInt(r[1]):1;break;case"dashed":t.plot.data[c].dashed=1;break;case"fill":t.plot.data[c].fill=r[1];break;case"outline":t.plot.data[c].outline=1;break;case"neon":t.plot.data[c].neon=1;break;case"image":t.lpattern[c]=NomanicObject.urlpath+"assets/"+NomanicObject.stripq(r[1]);break;case"alpha":t.plot.data[c].alpha=parseFloat(r[1]);break;case"colors":for(r=NomanicObject.stripc(NomanicObject.stripq(r[1])),o=0;o<r.length;o++)t.plot.data[c].colors[o]=NomanicObject.stripq(r[o]);break;case"donut":r=NomanicObject.stripc(NomanicObject.stripq(r[1])),t.plot.data[c].idonut=parseFloat(r[0]),t.plot.data[c].odonut=r[1]?parseFloat(r[1]):1}if(t.container.hasAttribute("lines")){for(s=NomanicObject.splitter(t.container.getAttribute("lines"),"{","}"),c=0;c<s.length;c++)for(t.plot.lines[c]={},i=NomanicObject.splitter(s[c]),l=0;l<i.length;l++)switch((r=i[l].split("|"))[1]=r[1]?r[1]:1,r[0]){case"series":t.plot.lines[c].series=NomanicObject.gary(r[1]);break;case"label":t.plot.lines[c].label=NomanicObject.stripq(r[1]);break;case"color":t.plot.lines[c].color=r[1];break;case"line":t.plot.data[c].line=r[1];break;case"spline":t.plot.lines[c].spline=1;break;case"cap":t.plot.lines[c].cap=1;break;case"dashed":t.plot.lines[c].dashed=1;break;case"average":t.plot.lines[c].average=1;break;case"sum":t.plot.lines[c].sum=1;break;case"fill":t.plot.lines[c].fill=r[1];break;case"outline":t.plot.data[c].outline=1;break;case"neon":t.plot.lines[c].neon=1;break;case"alpha":t.plot.lines[c].alpha=parseFloat(r[1])}"inline"==t.datatype&&(t.done=1)}return t},getowner:function(t){switch(t.layout.type){case"line":case"bar":case"polar":case"pie":case"halfpie":return NomanicGraph}return!1},parsecsv:function(t,e){var a,o=0,l=0,s=e.match(/[^\r\n]+/g),c=[],r=[];for(a=0;a<s.length;a++)s[a]=NomanicObject.gary(s[a]);if(t.plot.data&&(l+=t.plot.data.length),t.plot.lines&&(l+=t.plot.lines.length),l<=s.length){if(t.plot.data)for(a=0;a<t.plot.data.length;a++)c.push(s[o]),o++;if(t.plot.lines)for(a=0;a<t.plot.lines.length;a++)r.push(s[o]),o++}return[c,r]},loadcsv:function(t,e){var a,o=0,l=0,s=e.match(/[^\r\n]+/g);for(a=0;a<s.length;a++)s[a]=NomanicObject.gary(s[a]);if(t.plot.data&&(l+=t.plot.data.length),t.plot.lines&&(l+=t.plot.lines.length),l<=s.length){if(t.plot.data)for(a=0;a<t.plot.data.length;a++)t.plot.data[a].series=s[o],o++;if(t.plot.lines)for(a=0;a<t.plot.lines.length;a++)t.plot.lines[a].series=s[o],o++}return t.done=1,t},create:function(t){var e=t;return setTimeout(function(){var t,a=e;a.loadlegend=NomanicGraph.loadlegend,a.buildlegend=NomanicGraph.buildlegend,a.showdata=NomanicGraph.showdata,a.showlegend=function(t,a){return NomanicGraph.showlegend(e,t,a)},(a=(a=NomanicObject.createbefore(a)).buildlegend(a,0,a.plot.data)).plot.tagformat=a.plot.tagformat?a.plot.tagformat:"{u}"+(a.plot.stacked?" [{p0.00}%]":""),a.plot.menuformat=a.plot.menuformat?a.plot.menuformat:"{u}",a.plot.timestep=a.plot.timestep?a.plot.timestep:1,a.plot.timeunit=a.plot.timeunit?a.plot.timeunit:"d";var o,l,s=a.plot.data,c=0,r=s[0]?s[0].series.length:0;for(a.plot.totals=0,o=r-1;o>-1;o--){for(c=0,l=0;l<s.length;l++)a.plot.data[l].totals=a.plot.data[l].totals?a.plot.data[l].totals:[],c+=Math.abs(a.plot.data[l].series[o]);for(l=0;l<s.length;l++)a.plot.data[l].totals[o]=a.plot.stacked?c:Math.abs(a.plot.data[l].series[o])}for(l=0;l<s.length;l++)a.plot.totals+=Math.abs(a.plot.data[l].series[0]);if(a.rsr=NomanicObject.rsr,a.updateaxis=NomanicGraph.updateaxis,a.addClicks="polar"==a.layout.type?NomanicGraph.addClicksPolar:NomanicGraph.addClicks,a.getdata=function(t){return NomanicGraph.getdata(e,t)},a.getmenu=function(){return NomanicGraph.getmenu(e)},a.setselect=function(t){return NomanicGraph.setSelect(e,t)},a.getselect=function(t){return e.selx},a.getlegend=function(){return NomanicGraph.getlegend(e)},a.redolegend=function(t,a,o,l,s){return NomanicGraph.redolegend(t,a,o,l,s,e)},a.attach=function(t,a){return NomanicObject.attacher(e,t,a)},a.replace=function(t,a,o){return t.ajax?NomanicObject.postAjax(NomanicObject.urlpath+"data/"+t.ajax,[e,a,o],function(t,e){var a=NomanicGraph.parsecsv(e[0],t);NomanicGraph.replaced(e[0],a[0],a[1],e[1],e[2])}):NomanicGraph.replaced(e,t.data?t.data:[],t.lines?t.lines:[],a,o),e},a.update=function(t,a){return NomanicGraph.update(e,t.data?t.data:[],t.lines?t.lines:[],a),e},a.layout.gtype=1,a.layout.subtype=1,a.mtype=1,!(a=NomanicObject.loadlayout(a)).objects.wrapper)return a;switch(a.canvasratio=a.objects.graph.offsetWidth/a.objects.graph.offsetHeight,a.plot.donut=a.plot.donut?a.plot.donut:0,a.plot.donuty=a.plot.donuty?a.plot.donuty:.8,a.layout.type){case"line":a.redraw=NomanicGraph.NMCdrawLines,a.mtype=2,a.ctype=1,a.layout.showscroll=1;break;case"bar":a.redraw=NomanicGraph.NMCdrawBar,a.mtype=2,a.ctype=1,a.layout.showscroll=1;break;case"polar":a.redraw=NomanicGraph.NMCdrawPolar,a.updateaxis=NomanicGraph.updateaxisPolar,a.layout.gtype=1,a.plot.egg=0,a.layout.floatingtags=0,a.layout.showaxis=0,a.layout.showscroll=0,a.plot.stacked=1,a.selx=0,a.ctype=1,a.fixg=1;break;case"pie":a.pie=1,a.redraw=NomanicGraph.NMCdrawPie,a.layout.gtype=2,a.layout.floatingtags=0,a.layout.showaxis=0,a.layout.showgrid=0,a.layout.showscroll=0,a.layout.showmenu=0,a.selx=0,a.fixg=1;break;case"halfpie":a.pie=1,a.redraw=NomanicGraph.NMCdrawHalfPie,a.plot.egg=0,a.layout.gtype=2,a.layout.floatingtags=0,a.layout.showaxis=0,a.layout.showgrid=0,a.layout.showscroll=0,a.layout.showmenu=0,a.selx=0,a.fixg=1}a.czoom=100,a=NomanicObject.sortoutslider(a,1),a=NomanicObject.sortoutzoomslider(a,1),(a=NomanicObject.sortoutzoomslider(a,1,1)).objects.tray.style.top="0px",(a=NomanicObject.sortouttrayslider(a,1)).objects.tray.style.top="0px",a.objects.lscroller.style.top="0px",a.showtitle(a.layout.showtitle),(a=(a=NomanicObject.createafter(a)).updateaxis(a)).canvasratio=a.objects.graph.offsetWidth/a.objects.graph.offsetHeight,a.layout.showzoom?((t=a.objects.yscroller).setAttribute("NMC",a.id),t.style.cursor="pointer",a.draggie3=new Draggabilly(t,{containment:!0}),a.draggie3.on("dragMove",function(t,e,a){var o=NomanicObject.objs[parseInt(this.element.getAttribute("NMC"))];o=NomanicObject.sortoutzoomslider(o,1,1),NomanicObject.objs[o.id]=o}),(t=a.objects.xscroller).setAttribute("NMC",a.id),t.style.cursor="pointer",a.draggie4=new Draggabilly(t,{containment:!0}),a.draggie4.on("dragMove",function(t,e,a){var o=NomanicObject.objs[parseInt(this.element.getAttribute("NMC"))];o=NomanicObject.sortoutzoomslider(o,1),NomanicObject.objs[o.id]=o})):a.layout.vertical&&2==a.mtype?((t=a.objects.yscroller).setAttribute("NMC",a.id),t.style.cursor="pointer",a.draggie=new Draggabilly(t,{containment:!0}),a.draggie.on("dragMove",function(t,e,a){var o=NomanicObject.objs[parseInt(this.element.getAttribute("NMC"))];o=NomanicObject.sortoutslider(o,1),NomanicObject.objs[o.id]=o})):2==a.mtype&&((t=a.objects.xscroller).setAttribute("NMC",a.id),t.style.cursor="pointer",a.draggie=new Draggabilly(t,{containment:!0}),a.draggie.on("dragMove",function(t,e,a){var o=NomanicObject.objs[parseInt(this.element.getAttribute("NMC"))];o=NomanicObject.sortoutslider(o,1),NomanicObject.objs[o.id]=o})),a.draggie&&(a=NomanicObject.addMouse(a,a.objects.wrapper,a.layout.vertical?function(t,e){var a=NomanicObject.objs[e.id];t=window.event||t;var o=Math.max(-1,Math.min(1,t.wheelDelta||-t.detail));t.preventDefault(),a.objects.yscroller.style.top=a.objects.yscroller.offsetTop-o*NomanicObject.moused+"px",a=NomanicObject.sortoutslider(a,2),NomanicObject.objs[a.id]=a}:function(t,e){var a=NomanicObject.objs[e.id];t=window.event||t;var o=Math.max(-1,Math.min(1,t.wheelDelta||-t.detail));t.preventDefault(),a.objects.xscroller.style.left=a.objects.xscroller.offsetLeft-o*NomanicObject.moused+"px",a=NomanicObject.sortoutslider(a,2),NomanicObject.objs[a.id]=a})),a.layout.showzoom&&(a.objects.zoom.style.display="block",a.objects.zoomtx.innerHTML=a.czoom+"%",NomanicObject.addClick(a,a.objects.zoomup,function(t,e){(e=NomanicObject.objs[e.id]).objects.zoomup.style.backgroundColor="#F7CC30";var a=e;e.czoom=25*Math.floor((e.czoom+25)/25),e.czoom=e.czoom>2e3?2e3:e.czoom,e.objects.zoomtx.innerHTML=e.czoom+"%",NomanicObject.objs[e.id]=e,e.redraw(e),e=NomanicObject.sortoutslider(e,1),e=NomanicObject.sortoutzoomslider(e,1),e=NomanicObject.sortoutzoomslider(e,1,1),requestTimeout(function(){a.objects.zoomup.style.backgroundColor="#FFF"},500)}),NomanicObject.addClick(a,a.objects.zoomdn,function(t,e){(e=NomanicObject.objs[e.id]).objects.zoomdn.style.backgroundColor="#F7CC30";var a=e;e.czoom=25*Math.floor((e.czoom-25)/25),e.czoom=e.czoom<100?100:e.czoom,e.objects.zoomtx.innerHTML=e.czoom+"%",NomanicObject.objs[e.id]=e,e.redraw(e),e=NomanicObject.sortoutslider(e,1),e=NomanicObject.sortoutzoomslider(e,1),e=NomanicObject.sortoutzoomslider(e,1,1),requestTimeout(function(){a.objects.zoomdn.style.backgroundColor="#FFF"},500)})),a=NomanicObject.finally(a),NomanicObject.processThem()},50),t}};NomanicGraph.setup();